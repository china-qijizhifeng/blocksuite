{"version":3,"file":"stat-ops.js","sourceRoot":"","sources":["../../../../../../src/database-block/data-view/view/presets/table/stat-ops.ts"],"names":[],"mappings":"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","sourcesContent":["import { assertExists } from '@blocksuite/global/utils';\n\nimport type { GroupData } from '../../../common/group-by/helper.js';\nimport type { DataViewTableColumnManager } from './table-view-manager.js';\nimport type { StatCalcOpType } from './types.js';\n\nexport interface StatCalcOp {\n  type: StatCalcOpType;\n  label: string;\n  display: string;\n  calculate: (\n    column: DataViewTableColumnManager,\n    group?: GroupData\n  ) => StatOpResult;\n}\n\nexport type ColumnDataType = 'number' | 'checkbox' | 'other';\n\nexport type StatOpResult = {\n  value: number;\n  displayFormat: '%' | 'x10';\n};\n\nexport const commonCalcOps: StatCalcOp[] = [\n  {\n    type: 'none',\n    label: 'None',\n    display: 'Calculate',\n    calculate: () => {\n      return {\n        value: 0,\n        displayFormat: 'x10',\n      };\n    },\n  },\n\n  {\n    type: 'count-all',\n    label: 'Count All',\n    display: 'Count',\n    calculate: (c, g) => {\n      return {\n        value: c.stats.countAll(g),\n        displayFormat: 'x10',\n      };\n    },\n  },\n\n  {\n    type: 'count-values',\n    label: 'Count Values',\n    display: 'Values',\n    calculate: (c, g) => {\n      return {\n        value: c.stats.countValues(g),\n        displayFormat: 'x10',\n      };\n    },\n  },\n\n  {\n    type: 'count-uni-values',\n    label: 'Count Unique Values',\n    display: 'Unique',\n    calculate: (c, g) => {\n      return {\n        value: c.stats.countUniqueValues(g),\n        displayFormat: 'x10',\n      };\n    },\n  },\n\n  {\n    type: 'count-empty',\n    label: 'Count Empty',\n    display: 'Empty',\n    calculate: (c, g) => {\n      return {\n        value: c.stats.countEmpty(g),\n        displayFormat: 'x10',\n      };\n    },\n  },\n\n  {\n    type: 'count-not-empty',\n    label: 'Count Not Empty',\n    display: 'Not Empty',\n    calculate: (c, g) => {\n      return {\n        value: c.stats.countNonEmpty(g),\n        displayFormat: 'x10',\n      };\n    },\n  },\n\n  {\n    type: 'percent-empty',\n    label: 'Percent Empty',\n    display: 'Empty',\n    calculate: (c, g) => {\n      return {\n        value: c.stats.percentEmpty(g),\n        displayFormat: '%',\n      };\n    },\n  },\n\n  {\n    type: 'percent-not-empty',\n    label: 'Percent Not Empty',\n    display: 'Not Empty',\n    calculate: (c, g) => {\n      return {\n        value: c.stats.percentNonEmpty(g),\n        displayFormat: '%',\n      };\n    },\n  },\n];\n\nexport const numberColCalcOps: StatCalcOp[] = [\n  ...commonCalcOps,\n  {\n    type: 'sum',\n    label: 'Sum',\n    display: 'Sum',\n    calculate: (c, g) => {\n      return {\n        value: c.stats.sum(g),\n        displayFormat: 'x10',\n      };\n    },\n  },\n  {\n    type: 'avg',\n    label: 'Average',\n    display: 'Avg',\n    calculate: (c, g) => {\n      return {\n        value: c.stats.mean(g),\n        displayFormat: 'x10',\n      };\n    },\n  },\n\n  {\n    type: 'median',\n    label: 'Median',\n    display: 'Median',\n    calculate: (c, g) => {\n      return {\n        value: c.stats.median(g),\n        displayFormat: 'x10',\n      };\n    },\n  },\n\n  {\n    type: 'mode',\n    label: 'Mode',\n    display: 'Mode',\n    calculate: (c, g) => {\n      return {\n        value: c.stats.mode(g),\n        displayFormat: 'x10',\n      };\n    },\n  },\n\n  {\n    type: 'min',\n    label: 'Min',\n    display: 'Min',\n    calculate: (c, g) => {\n      return {\n        value: c.stats.min(g),\n        displayFormat: 'x10',\n      };\n    },\n  },\n  {\n    type: 'max',\n    label: 'Max',\n    display: 'Max',\n    calculate: (c, g) => {\n      return {\n        value: c.stats.max(g),\n        displayFormat: 'x10',\n      };\n    },\n  },\n\n  {\n    type: 'range',\n    label: 'Range',\n    display: 'Range',\n    calculate: (c, g) => {\n      return {\n        value: c.stats.range(g),\n        displayFormat: 'x10',\n      };\n    },\n  },\n];\n\nexport const checkboxCalcOps: StatCalcOp[] = [\n  ...commonCalcOps.slice(0, 2),\n  {\n    type: 'checked',\n    label: 'Checked',\n    display: 'Checked',\n    calculate: (c, g) => {\n      return {\n        value: c.stats.checked(g),\n        displayFormat: 'x10',\n      };\n    },\n  },\n  {\n    type: 'not-checked',\n    label: 'Not Checked',\n    display: 'Not Checked',\n    calculate: (c, g) => {\n      return {\n        value: c.stats.notChecked(g),\n        displayFormat: 'x10',\n      };\n    },\n  },\n  {\n    type: 'percent-checked',\n    label: 'Percent Checked',\n    display: 'Checked',\n    calculate: (c, g) => {\n      return {\n        value: c.stats.percentChecked(g),\n        displayFormat: '%',\n      };\n    },\n  },\n  {\n    type: 'percent-not-checked',\n    label: 'Percent Not Checked',\n    display: 'Not Checked',\n    calculate: (c, g) => {\n      return {\n        value: c.stats.percentNotChecked(g),\n        displayFormat: '%',\n      };\n    },\n  },\n];\n\nconst allCalcOps = Array.from(\n  new Set([...commonCalcOps, ...numberColCalcOps, ...checkboxCalcOps])\n);\n\nexport function getStatCalcOperationFromType(type: StatCalcOpType): StatCalcOp {\n  const operation = allCalcOps.find(op => op.type === type);\n  assertExists(operation, `Invalid operation type ${type}`);\n  return operation;\n}\n"]}