{"version":3,"file":"layout.js","sourceRoot":"","sources":["../../../src/_common/mind-map/layout.ts"],"names":[],"mappings":"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","sourcesContent":["export type LayoutNode = {\n  width: number;\n  height: number;\n  children: LayoutNode[];\n};\nexport type Connector = {\n  direction: 'left' | 'right' | 'top' | 'bottom';\n  parentId: string;\n} | null;\nexport type LayoutNodeResult = {\n  self: {\n    x: number;\n    y: number;\n    width: number;\n    height: number;\n  };\n  children: LayoutNodeResult[];\n};\nexport type LayoutOptions = {\n  gapVertical?: number;\n  gapHorizontal?: number;\n  x?: number;\n  y?: number;\n};\nexport type Layout = (\n  node: LayoutNode,\n  options?: LayoutOptions\n) => LayoutNodeResult;\ntype LayoutOptionsRequired = Required<LayoutOptions>;\nconst defaultOptions: LayoutOptionsRequired = {\n  gapHorizontal: 130,\n  gapVertical: 10,\n  x: 0,\n  y: 0,\n};\ntype BoxWithHeight = {\n  self: LayoutNode;\n  height: number;\n  children: BoxWithHeight[];\n};\nconst sum = (arr: number[]) => arr.reduce((prev, cur) => prev + cur, 0);\nconst computeBoxHeight = (\n  node: LayoutNode,\n  options: LayoutOptionsRequired\n): BoxWithHeight => {\n  const { height } = node;\n  const children = node.children.map(child => computeBoxHeight(child, options));\n  return {\n    self: node,\n    height: Math.max(\n      height,\n      children.reduce((prev, cur) => prev + cur.height, 0) +\n        options.gapVertical * (children.length - 1)\n    ),\n    children,\n  };\n};\nconst computePositionRight = (\n  node: BoxWithHeight,\n  x: number,\n  y: number,\n  options: LayoutOptionsRequired\n): LayoutNodeResult => {\n  const { self, children, height } = node;\n  const result: LayoutNodeResult = {\n    self: {\n      x: x,\n      y: y - self.height / 2,\n      width: self.width,\n      height: self.height,\n    },\n    children: [],\n  };\n  let top = y - height / 2;\n  children.forEach(child => {\n    const { height } = child;\n    const childY = top + height / 2;\n    top += height + options.gapVertical;\n    result.children.push(\n      computePositionRight(\n        child,\n        x + node.self.width + options.gapHorizontal,\n        childY,\n        options\n      )\n    );\n  });\n  return result;\n};\n\nconst rightLayout: Layout = (node, options) => {\n  const realOptions = { ...defaultOptions, ...options };\n\n  const box = computeBoxHeight(node, realOptions);\n  return computePositionRight(box, realOptions.x, realOptions.y, realOptions);\n};\n\nconst computePositionLeft = (\n  node: BoxWithHeight,\n  x: number,\n  y: number,\n  options: LayoutOptionsRequired\n): LayoutNodeResult => {\n  const { self, children, height } = node;\n  const result: LayoutNodeResult = {\n    self: {\n      x: x - self.width,\n      y: y - self.height / 2,\n      width: self.width,\n      height: self.height,\n    },\n    children: [],\n  };\n  let top = y - height / 2;\n  children.forEach(child => {\n    const { height } = child;\n    const childY = top + height / 2;\n    top += height + options.gapVertical;\n    result.children.push(\n      computePositionLeft(\n        child,\n        x - node.self.width - options.gapHorizontal,\n        childY,\n        options\n      )\n    );\n  });\n  return result;\n};\n\nconst leftLayout: Layout = (node, options) => {\n  const realOptions = { ...defaultOptions, ...options };\n  const box = computeBoxHeight(node, realOptions);\n  return computePositionLeft(box, 0, 0, realOptions);\n};\n\nconst leftRightLayout: Layout = (node, options) => {\n  const realOptions = { ...defaultOptions, ...options };\n  const boxList = node.children.map(child =>\n    computeBoxHeight(child, realOptions)\n  );\n  const mid = boxList.reduce((prev, cur) => Math.max(prev, cur.height), 0) / 2;\n  const leftBox: BoxWithHeight[] = [];\n  const rightBox: BoxWithHeight[] = [];\n  let left = true;\n  let currentTop = 0;\n  boxList.forEach(box => {\n    if (left) {\n      leftBox.push(box);\n    } else {\n      rightBox.push(box);\n    }\n    currentTop += box.height;\n    if (left && currentTop > mid) {\n      left = false;\n      currentTop = 0;\n    }\n  });\n  let rightTop =\n    0 -\n    (sum(rightBox.map(v => v.height)) +\n      realOptions.gapVertical * (rightBox.length - 1)) /\n      2;\n  let leftTop =\n    0 -\n    (leftBox.reduce((prev, cur) => prev + cur.height, 0) +\n      realOptions.gapVertical * (leftBox.length - 1)) /\n      2;\n  const root: LayoutNodeResult = {\n    self: {\n      x: 0 - node.width / 2,\n      y: 0 - node.height / 2,\n      width: node.width,\n      height: node.height,\n    },\n    children: [],\n  };\n  leftBox.forEach(box => {\n    root.children.push(\n      computePositionLeft(\n        box,\n        0 - (node.width / 2 + realOptions.gapHorizontal),\n        leftTop + box.height / 2,\n        realOptions\n      )\n    );\n    leftTop += box.height + realOptions.gapVertical;\n  });\n  rightBox.forEach(box => {\n    root.children.push(\n      computePositionRight(\n        box,\n        node.width / 2 + realOptions.gapHorizontal,\n        rightTop + box.height / 2,\n        realOptions\n      )\n    );\n    rightTop += box.height + realOptions.gapVertical;\n  });\n  return root;\n};\n\ntype BoxWithWidth = {\n  self: LayoutNode;\n  width: number;\n  children: BoxWithWidth[];\n};\n\nconst computeBoxWidth = (\n  node: LayoutNode,\n  options: LayoutOptionsRequired\n): BoxWithWidth => {\n  const { width } = node;\n  const children = node.children.map(child => computeBoxWidth(child, options));\n  return {\n    self: node,\n    width: Math.max(\n      width,\n      children.reduce((prev, cur) => prev + cur.width, 0) +\n        options.gapHorizontal * (children.length - 1)\n    ),\n    children,\n  };\n};\n\nconst computePositionTop = (\n  node: BoxWithWidth,\n  x: number,\n  y: number,\n  options: LayoutOptionsRequired\n): LayoutNodeResult => {\n  const { self, children, width } = node;\n  const result: LayoutNodeResult = {\n    self: {\n      x,\n      y,\n      width: self.width,\n      height: self.height,\n    },\n    children: [],\n  };\n  let left = x - width / 2;\n  children.forEach(child => {\n    const { self, width } = child;\n    const childX = left + width / 2;\n    left += width + options.gapHorizontal;\n    result.children.push(\n      computePositionTop(\n        child,\n        childX,\n        y - self.height - options.gapVertical,\n        options\n      )\n    );\n  });\n  return result;\n};\n\nconst topLayout: Layout = (node, options) => {\n  const realOptions = { ...defaultOptions, ...options };\n  const box = computeBoxWidth(node, realOptions);\n  return computePositionTop(box, 0, 0, realOptions);\n};\n\nconst computePositionBottom = (\n  node: BoxWithWidth,\n  x: number,\n  y: number,\n  options: LayoutOptionsRequired\n): LayoutNodeResult => {\n  const { self, children, width } = node;\n  const result: LayoutNodeResult = {\n    self: {\n      x,\n      y,\n      width: self.width,\n      height: self.height,\n    },\n    children: [],\n  };\n  let left = x - width / 2;\n  children.forEach(child => {\n    const { self, width } = child;\n    const childX = left + width / 2;\n    left += width + options.gapHorizontal;\n    result.children.push(\n      computePositionBottom(\n        child,\n        childX,\n        y + self.height + options.gapVertical,\n        options\n      )\n    );\n  });\n  return result;\n};\n\nconst bottomLayout: Layout = (node, options) => {\n  const realOptions = { ...defaultOptions, ...options };\n  const box = computeBoxWidth(node, realOptions);\n  return computePositionBottom(box, 0, 0, realOptions);\n};\n\nconst topBottomLayout: Layout = (node, options) => {\n  const realOptions = { ...defaultOptions, ...options };\n  const boxList = node.children.map(child =>\n    computeBoxWidth(child, realOptions)\n  );\n  const mid = boxList.reduce((prev, cur) => Math.max(prev, cur.width), 0) / 2;\n  const topBox: BoxWithWidth[] = [];\n  const bottomBox: BoxWithWidth[] = [];\n  let top = true;\n  let currentLeft = 0;\n  boxList.forEach(box => {\n    if (top) {\n      topBox.push(box);\n    } else {\n      bottomBox.push(box);\n    }\n    currentLeft += box.width;\n    if (top && currentLeft > mid) {\n      top = false;\n      currentLeft = 0;\n    }\n  });\n  let topLeft =\n    0 -\n    (sum(topBox.map(v => v.width)) +\n      realOptions.gapHorizontal * (topBox.length - 1)) /\n      2;\n  let bottomLeft =\n    0 -\n    (bottomBox.reduce((prev, cur) => prev + cur.width, 0) +\n      realOptions.gapHorizontal * (bottomBox.length - 1)) /\n      2;\n  const root: LayoutNodeResult = {\n    self: {\n      x: 0,\n      y: 0,\n      width: node.width,\n      height: node.height,\n    },\n    children: [],\n  };\n  topBox.forEach(box => {\n    root.children.push(\n      computePositionTop(\n        box,\n        topLeft + box.width / 2,\n        0 - (node.height / 2 + realOptions.gapVertical),\n        realOptions\n      )\n    );\n    topLeft += box.width + realOptions.gapHorizontal;\n  });\n  bottomBox.forEach(box => {\n    root.children.push(\n      computePositionBottom(\n        box,\n        bottomLeft + box.width / 2,\n        node.height / 2 + realOptions.gapVertical,\n        realOptions\n      )\n    );\n    bottomLeft += box.width + realOptions.gapHorizontal;\n  });\n  return root;\n};\nexport const layout = {\n  right: rightLayout,\n  left: leftLayout,\n  leftRight: leftRightLayout,\n  top: topLayout,\n  bottom: bottomLayout,\n  topBottom: topBottomLayout,\n} satisfies Record<string, Layout>;\n"]}