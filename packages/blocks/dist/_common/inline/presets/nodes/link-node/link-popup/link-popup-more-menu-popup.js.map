{"version":3,"file":"link-popup-more-menu-popup.js","sourceRoot":"","sources":["../../../../../../../src/_common/inline/presets/nodes/link-node/link-popup/link-popup-more-menu-popup.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACA,OAAO,EAAE,cAAc,EAAE,MAAM,uBAAuB,CAAC;AACvD,OAAO,EAAE,YAAY,EAAE,MAAM,0BAA0B,CAAC;AAExD,OAAO,EAAE,GAAG,EAAE,IAAI,EAAE,UAAU,EAAE,MAAM,KAAK,CAAC;AAC5C,OAAO,EAAE,aAAa,EAAE,QAAQ,EAAE,MAAM,mBAAmB,CAAC;AAE5D,OAAO,EAAE,KAAK,EAAE,MAAM,oCAAoC,CAAC;AAC3D,OAAO,EACL,QAAQ,EACR,UAAU,EACV,QAAQ,EACR,UAAU,GACX,MAAM,+BAA+B,CAAC;IAI1B,iBAAiB;4BAD7B,aAAa,CAAC,sBAAsB,CAAC;;;;sBACC,cAAc,CAAC,UAAU,CAAC;;;;;;;;;;;;;iCAAlC,SAAQ,WAA0B;;;;wCA6C9D,QAAQ,CAAC,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC;6CAG9B,QAAQ,CAAC,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC;2CAG9B,QAAQ,CAAC,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC;gCAG9B,QAAQ,CAAC,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC;YAR/B,yLAAS,YAAY,6BAAZ,YAAY,mGAAsB;YAG3C,wMAAS,iBAAiB,6BAAjB,iBAAiB,6GAAe;YAGzC,kMAAS,eAAe,6BAAf,eAAe,yGAAmB;YAG3C,iKAAS,IAAI,6BAAJ,IAAI,mFAAc;YAvD7B,6KA+IC;;;;iBA9IiB,WAAM,GAAG,GAAG,CAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;GA0C3B,AA1CqB,CA0CpB;QAGF,6FAA2C;QAA3C,IAAS,YAAY,kDAAsB;QAA3C,IAAS,YAAY,wDAAsB;QAG3C,mKAAyC;QAAzC,IAAS,iBAAiB,uDAAe;QAAzC,IAAS,iBAAiB,6DAAe;QAGzC,oKAA2C;QAA3C,IAAS,eAAe,qDAAmB;QAA3C,IAAS,eAAe,2DAAmB;QAG3C,4IAA2B;QAA3B,IAAS,IAAI,0CAAc;QAA3B,IAAS,IAAI,gDAAc;QAE3B,IAAI,WAAW;YACb,MAAM,IAAI,GAAG,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC,IAAI,CAAC;YACtE,YAAY,CAAC,IAAI,CAAC,CAAC;YACnB,OAAO,IAAI,CAAC;QACd,CAAC;QAEO,SAAS;YACf,IAAI,IAAI,GAAG,IAAI,CAAC,WAAW,CAAC;YAC5B,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,iBAAiB,CAAC,EAAE,CAAC;gBACnC,IAAI,GAAG,UAAU,GAAG,IAAI,CAAC;YAC3B,CAAC;YACD,MAAM,CAAC,IAAI,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC;YAC5B,IAAI,CAAC,eAAe,CAAC,KAAK,EAAE,CAAC;QAC/B,CAAC;QAEO,QAAQ;YACd,SAAS,CAAC,SAAS,CAAC,SAAS,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;YACrE,KAAK,CAAC,IAAI,CAAC,IAAI,EAAE,0BAA0B,CAAC,CAAC;YAC7C,IAAI,CAAC,eAAe,CAAC,KAAK,EAAE,CAAC;QAC/B,CAAC;QAEO,WAAW;YACjB,IAAI,IAAI,CAAC,YAAY,CAAC,kBAAkB,CAAC,IAAI,CAAC,iBAAiB,CAAC,EAAE,CAAC;gBACjE,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC,IAAI,CAAC,iBAAiB,EAAE;oBACnD,IAAI,EAAE,IAAI;iBACX,CAAC,CAAC;YACL,CAAC;YACD,IAAI,CAAC,eAAe,CAAC,KAAK,EAAE,CAAC;QAC/B,CAAC;QAEO,OAAO;YACb,IAAI,IAAI,CAAC,YAAY,CAAC,kBAAkB,CAAC,IAAI,CAAC,iBAAiB,CAAC,EAAE,CAAC;gBACjE,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC;YACvD,CAAC;YACD,IAAI,CAAC,eAAe,CAAC,KAAK,EAAE,CAAC;QAC/B,CAAC;QAEQ,MAAM;YACb,OAAO,IAAI,CAAA;;;;;;;;qBAQM,GAAG,EAAE,CAAC,IAAI,CAAC,SAAS,EAAE;;cAE7B,QAAQ;;;;;;;;qBAQD,GAAG,EAAE,CAAC,IAAI,CAAC,QAAQ,EAAE;;cAE5B,QAAQ;;;;;;;;qBAQD,GAAG,EAAE,CAAC,IAAI,CAAC,WAAW,EAAE;;cAE/B,UAAU;;;;;;;;;;qBAUH,GAAG,EAAE,CAAC,IAAI,CAAC,OAAO,EAAE;;cAE3B,UAAU;;;;KAInB,CAAC;QACJ,CAAC;;;;;;YA9IU,uDAAiB;;;;;SAAjB,iBAAiB","sourcesContent":["import type { EditorHost } from '@blocksuite/block-std';\nimport { WithDisposable } from '@blocksuite/block-std';\nimport { assertExists } from '@blocksuite/global/utils';\nimport type { InlineRange } from '@blocksuite/inline/types';\nimport { css, html, LitElement } from 'lit';\nimport { customElement, property } from 'lit/decorators.js';\n\nimport { toast } from '../../../../../components/toast.js';\nimport {\n  CopyIcon,\n  DeleteIcon,\n  OpenIcon,\n  UnlinkIcon,\n} from '../../../../../icons/index.js';\nimport type { AffineInlineEditor } from '../../../affine-inline-specs.js';\n\n@customElement('link-popup-more-menu')\nexport class LinkPopupMoreMenu extends WithDisposable(LitElement) {\n  static override styles = css`\n    .link-popup-more-menu {\n      box-sizing: border-box;\n      padding-bottom: 4px;\n    }\n\n    .link-popup-more-menu-container {\n      border-radius: 8px;\n      padding: 8px;\n      background: var(--affine-background-overlay-panel-color);\n      box-shadow: var(--affine-shadow-2);\n    }\n\n    .link-popup-more-menu-container > .menu-item {\n      display: flex;\n      justify-content: flex-start;\n      align-items: center;\n      width: 100%;\n    }\n\n    .link-popup-more-menu-container > .menu-item:hover {\n      background: var(--affine-hover-color);\n    }\n\n    .link-popup-more-menu-container > .menu-item:hover.delete {\n      background: var(--affine-background-error-color);\n      color: var(--affine-error-color);\n    }\n    .link-popup-more-menu > .menu-item:hover.delete > svg {\n      color: var(--affine-error-color);\n    }\n\n    .link-popup-more-menu-container > .menu-item svg {\n      margin: 0 8px;\n    }\n\n    .link-popup-more-menu-container > .divider {\n      width: 148px;\n      height: 1px;\n      margin: 8px;\n      background-color: var(--affine-border-color);\n    }\n  `;\n\n  @property({ attribute: false })\n  accessor inlineEditor!: AffineInlineEditor;\n\n  @property({ attribute: false })\n  accessor targetInlineRange!: InlineRange;\n\n  @property({ attribute: false })\n  accessor abortController!: AbortController;\n\n  @property({ attribute: false })\n  accessor host!: EditorHost;\n\n  get currentLink() {\n    const link = this.inlineEditor.getFormat(this.targetInlineRange).link;\n    assertExists(link);\n    return link;\n  }\n\n  private _openLink() {\n    let link = this.currentLink;\n    if (!link.match(/^[a-zA-Z]+:\\/\\//)) {\n      link = 'https://' + link;\n    }\n    window.open(link, '_blank');\n    this.abortController.abort();\n  }\n\n  private _copyUrl() {\n    navigator.clipboard.writeText(this.currentLink).catch(console.error);\n    toast(this.host, 'Copied link to clipboard');\n    this.abortController.abort();\n  }\n\n  private _removeLink() {\n    if (this.inlineEditor.isValidInlineRange(this.targetInlineRange)) {\n      this.inlineEditor.formatText(this.targetInlineRange, {\n        link: null,\n      });\n    }\n    this.abortController.abort();\n  }\n\n  private _delete() {\n    if (this.inlineEditor.isValidInlineRange(this.targetInlineRange)) {\n      this.inlineEditor.deleteText(this.targetInlineRange);\n    }\n    this.abortController.abort();\n  }\n\n  override render() {\n    return html`\n      <div class=\"link-popup-more-menu\">\n        <div class=\"link-popup-more-menu-container\">\n          <icon-button\n            width=\"126px\"\n            height=\"32px\"\n            class=\"menu-item open\"\n            text=\"Open\"\n            @click=${() => this._openLink()}\n          >\n            ${OpenIcon}\n          </icon-button>\n\n          <icon-button\n            width=\"126px\"\n            height=\"32px\"\n            class=\"menu-item copy\"\n            text=\"Copy\"\n            @click=${() => this._copyUrl()}\n          >\n            ${CopyIcon}\n          </icon-button>\n\n          <icon-button\n            width=\"126px\"\n            height=\"32px\"\n            class=\"menu-item unlink\"\n            text=\"Remove link\"\n            @click=${() => this._removeLink()}\n          >\n            ${UnlinkIcon}\n          </icon-button>\n\n          <div class=\"divider\"></div>\n\n          <icon-button\n            width=\"126px\"\n            height=\"32px\"\n            class=\"menu-item delete\"\n            text=\"Delete\"\n            @click=${() => this._delete()}\n          >\n            ${DeleteIcon}\n          </icon-button>\n        </div>\n      </div>\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'link-popup-more-menu': LinkPopupMoreMenu;\n  }\n}\n"]}