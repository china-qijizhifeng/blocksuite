{"version":3,"file":"markdown.js","sourceRoot":"","sources":["../../../../src/_common/inline/presets/markdown.ts"],"names":[],"mappings":"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","sourcesContent":["/* eslint-disable no-useless-escape */\n\nimport {\n  KEYBOARD_ALLOW_DEFAULT,\n  KEYBOARD_PREVENT_DEFAULT,\n} from '@blocksuite/inline';\n\nimport type { InlineMarkdownMatch } from '../inline-manager.js';\nimport type { AffineTextAttributes } from './affine-inline-specs.js';\n\n// inline markdown match rules:\n// covert: ***test*** + space\n// covert: ***t est*** + space\n// not convert: *** test*** + space\n// not convert: ***test *** + space\n// not convert: *** test *** + space\nexport const affineInlineMarkdownMatches: InlineMarkdownMatch<AffineTextAttributes>[] =\n  [\n    {\n      name: 'bolditalic',\n      pattern: /(?:\\*\\*\\*)([^\\s\\*](?:[^*]*?[^\\s\\*])?)(?:\\*\\*\\*)$/g,\n      action: ({\n        inlineEditor,\n        prefixText,\n        inlineRange,\n        pattern,\n        undoManager,\n      }) => {\n        const match = pattern.exec(prefixText);\n        if (!match) {\n          return KEYBOARD_ALLOW_DEFAULT;\n        }\n\n        const annotatedText = match[0];\n        const startIndex = inlineRange.index - annotatedText.length;\n\n        inlineEditor.insertText(\n          {\n            index: startIndex + annotatedText.length,\n            length: 0,\n          },\n          ' '\n        );\n        inlineEditor.setInlineRange({\n          index: startIndex + annotatedText.length + 1,\n          length: 0,\n        });\n\n        undoManager.stopCapturing();\n\n        inlineEditor.formatText(\n          {\n            index: startIndex,\n            length: annotatedText.length,\n          },\n          {\n            bold: true,\n            italic: true,\n          }\n        );\n\n        inlineEditor.deleteText({\n          index: startIndex + annotatedText.length,\n          length: 1,\n        });\n        inlineEditor.deleteText({\n          index: startIndex + annotatedText.length - 3,\n          length: 3,\n        });\n        inlineEditor.deleteText({\n          index: startIndex,\n          length: 3,\n        });\n\n        inlineEditor.setInlineRange({\n          index: startIndex + annotatedText.length - 6,\n          length: 0,\n        });\n\n        return KEYBOARD_PREVENT_DEFAULT;\n      },\n    },\n    {\n      name: 'bold',\n      pattern: /(?:\\*\\*)([^\\s\\*](?:[^*]*?[^\\s\\*])?)(?:\\*\\*)$/g,\n      action: ({\n        inlineEditor,\n        prefixText,\n        inlineRange,\n        pattern,\n        undoManager,\n      }) => {\n        const match = pattern.exec(prefixText);\n        if (!match) {\n          return KEYBOARD_ALLOW_DEFAULT;\n        }\n        const annotatedText = match[0];\n        const startIndex = inlineRange.index - annotatedText.length;\n\n        inlineEditor.insertText(\n          {\n            index: startIndex + annotatedText.length,\n            length: 0,\n          },\n          ' '\n        );\n        inlineEditor.setInlineRange({\n          index: startIndex + annotatedText.length + 1,\n          length: 0,\n        });\n\n        undoManager.stopCapturing();\n\n        inlineEditor.formatText(\n          {\n            index: startIndex,\n            length: annotatedText.length,\n          },\n          {\n            bold: true,\n          }\n        );\n\n        inlineEditor.deleteText({\n          index: startIndex + annotatedText.length,\n          length: 1,\n        });\n        inlineEditor.deleteText({\n          index: startIndex + annotatedText.length - 2,\n          length: 2,\n        });\n        inlineEditor.deleteText({\n          index: startIndex,\n          length: 2,\n        });\n\n        inlineEditor.setInlineRange({\n          index: startIndex + annotatedText.length - 4,\n          length: 0,\n        });\n\n        return KEYBOARD_PREVENT_DEFAULT;\n      },\n    },\n    {\n      name: 'italic',\n      pattern: /(?:\\*)([^\\s\\*](?:[^*]*?[^\\s\\*])?)(?:\\*)$/g,\n      action: ({\n        inlineEditor,\n        prefixText,\n        inlineRange,\n        pattern,\n        undoManager,\n      }) => {\n        const match = pattern.exec(prefixText);\n        if (!match) {\n          return KEYBOARD_ALLOW_DEFAULT;\n        }\n        const annotatedText = match[0];\n        const startIndex = inlineRange.index - annotatedText.length;\n\n        inlineEditor.insertText(\n          {\n            index: startIndex + annotatedText.length,\n            length: 0,\n          },\n          ' '\n        );\n        inlineEditor.setInlineRange({\n          index: startIndex + annotatedText.length + 1,\n          length: 0,\n        });\n\n        undoManager.stopCapturing();\n\n        inlineEditor.formatText(\n          {\n            index: startIndex,\n            length: annotatedText.length,\n          },\n          {\n            italic: true,\n          }\n        );\n\n        inlineEditor.deleteText({\n          index: startIndex + annotatedText.length,\n          length: 1,\n        });\n        inlineEditor.deleteText({\n          index: startIndex + annotatedText.length - 1,\n          length: 1,\n        });\n        inlineEditor.deleteText({\n          index: startIndex,\n          length: 1,\n        });\n\n        inlineEditor.setInlineRange({\n          index: startIndex + annotatedText.length - 2,\n          length: 0,\n        });\n\n        return KEYBOARD_PREVENT_DEFAULT;\n      },\n    },\n    {\n      name: 'strikethrough',\n      pattern: /(?:~~)([^\\s~](?:[^~]*?[^\\s~])?)(?:~~)$/g,\n      action: ({\n        inlineEditor,\n        prefixText,\n        inlineRange,\n        pattern,\n        undoManager,\n      }) => {\n        const match = pattern.exec(prefixText);\n        if (!match) {\n          return KEYBOARD_ALLOW_DEFAULT;\n        }\n        const annotatedText = match[0];\n        const startIndex = inlineRange.index - annotatedText.length;\n\n        inlineEditor.insertText(\n          {\n            index: startIndex + annotatedText.length,\n            length: 0,\n          },\n          ' '\n        );\n        inlineEditor.setInlineRange({\n          index: startIndex + annotatedText.length + 1,\n          length: 0,\n        });\n\n        undoManager.stopCapturing();\n\n        inlineEditor.formatText(\n          {\n            index: startIndex,\n            length: annotatedText.length,\n          },\n          {\n            strike: true,\n          }\n        );\n\n        inlineEditor.deleteText({\n          index: startIndex + annotatedText.length,\n          length: 1,\n        });\n        inlineEditor.deleteText({\n          index: startIndex + annotatedText.length - 2,\n          length: 2,\n        });\n        inlineEditor.deleteText({\n          index: startIndex,\n          length: 2,\n        });\n\n        inlineEditor.setInlineRange({\n          index: startIndex + annotatedText.length - 4,\n          length: 0,\n        });\n\n        return KEYBOARD_PREVENT_DEFAULT;\n      },\n    },\n    {\n      name: 'underthrough',\n      pattern: /(?:~)([^\\s~](?:[^~]*?[^\\s~])?)(?:~)$/g,\n      action: ({\n        inlineEditor,\n        prefixText,\n        inlineRange,\n        pattern,\n        undoManager,\n      }) => {\n        const match = pattern.exec(prefixText);\n        if (!match) {\n          return KEYBOARD_ALLOW_DEFAULT;\n        }\n        const annotatedText = match[0];\n        const startIndex = inlineRange.index - annotatedText.length;\n\n        inlineEditor.insertText(\n          {\n            index: startIndex + annotatedText.length,\n            length: 0,\n          },\n          ' '\n        );\n        inlineEditor.setInlineRange({\n          index: startIndex + annotatedText.length + 1,\n          length: 0,\n        });\n\n        undoManager.stopCapturing();\n\n        inlineEditor.formatText(\n          {\n            index: startIndex,\n            length: annotatedText.length,\n          },\n          {\n            underline: true,\n          }\n        );\n\n        inlineEditor.deleteText({\n          index: startIndex + annotatedText.length,\n          length: 1,\n        });\n        inlineEditor.deleteText({\n          index: inlineRange.index - 1,\n          length: 1,\n        });\n        inlineEditor.deleteText({\n          index: startIndex,\n          length: 1,\n        });\n\n        inlineEditor.setInlineRange({\n          index: startIndex + annotatedText.length - 2,\n          length: 0,\n        });\n\n        return KEYBOARD_PREVENT_DEFAULT;\n      },\n    },\n    {\n      name: 'code',\n      pattern: /(?:`)([^\\s`](?:[^`]*?[^\\s`])?)(?:`)$/g,\n      action: ({\n        inlineEditor,\n        prefixText,\n        inlineRange,\n        pattern,\n        undoManager,\n      }) => {\n        const match = pattern.exec(prefixText);\n        if (!match) {\n          return KEYBOARD_ALLOW_DEFAULT;\n        }\n        const annotatedText = match[0];\n        const startIndex = inlineRange.index - annotatedText.length;\n\n        if (prefixText.match(/^([* \\n]+)$/g)) {\n          return KEYBOARD_ALLOW_DEFAULT;\n        }\n\n        inlineEditor.insertText(\n          {\n            index: startIndex + annotatedText.length,\n            length: 0,\n          },\n          ' '\n        );\n        inlineEditor.setInlineRange({\n          index: startIndex + annotatedText.length + 1,\n          length: 0,\n        });\n\n        undoManager.stopCapturing();\n\n        inlineEditor.formatText(\n          {\n            index: startIndex,\n            length: annotatedText.length,\n          },\n          {\n            code: true,\n          }\n        );\n\n        inlineEditor.deleteText({\n          index: startIndex + annotatedText.length,\n          length: 1,\n        });\n        inlineEditor.deleteText({\n          index: startIndex + annotatedText.length - 1,\n          length: 1,\n        });\n        inlineEditor.deleteText({\n          index: startIndex,\n          length: 1,\n        });\n\n        inlineEditor.setInlineRange({\n          index: startIndex + annotatedText.length - 2,\n          length: 0,\n        });\n\n        return KEYBOARD_PREVENT_DEFAULT;\n      },\n    },\n    {\n      name: 'link',\n      pattern: /(?:\\[(.+?)\\])(?:\\((.+?)\\))$/g,\n      action: ({\n        inlineEditor,\n        prefixText,\n        inlineRange,\n        pattern,\n        undoManager,\n      }) => {\n        const startIndex = prefixText.search(pattern);\n        const matchedText = prefixText.match(pattern)?.[0];\n        const hrefText = prefixText.match(/(?:\\[(.*?)\\])/g)?.[0];\n        const hrefLink = prefixText.match(/(?:\\((.*?)\\))/g)?.[0];\n        if (startIndex === -1 || !matchedText || !hrefText || !hrefLink) {\n          return KEYBOARD_ALLOW_DEFAULT;\n        }\n        const start = inlineRange.index - matchedText.length;\n\n        inlineEditor.insertText(\n          {\n            index: inlineRange.index,\n            length: 0,\n          },\n          ' '\n        );\n        inlineEditor.setInlineRange({\n          index: inlineRange.index + 1,\n          length: 0,\n        });\n\n        undoManager.stopCapturing();\n\n        inlineEditor.formatText(\n          {\n            index: start,\n            length: hrefText.length,\n          },\n          {\n            link: hrefLink.slice(1, hrefLink.length - 1),\n          }\n        );\n\n        inlineEditor.deleteText({\n          index: inlineRange.index + matchedText.length,\n          length: 1,\n        });\n        inlineEditor.deleteText({\n          index: inlineRange.index - hrefLink.length - 1,\n          length: hrefLink.length + 1,\n        });\n        inlineEditor.deleteText({\n          index: start,\n          length: 1,\n        });\n\n        inlineEditor.setInlineRange({\n          index: start + hrefText.length - 1,\n          length: 0,\n        });\n\n        return KEYBOARD_PREVENT_DEFAULT;\n      },\n    },\n  ];\n"]}