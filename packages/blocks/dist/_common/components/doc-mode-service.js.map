{"version":3,"file":"doc-mode-service.js","sourceRoot":"","sources":["../../../src/_common/components/doc-mode-service.ts"],"names":[],"mappings":"AACA,OAAO,EAAE,IAAI,EAAE,MAAM,0BAA0B,CAAC;AAchD,MAAM,YAAY,GAAG,MAAM,CAAC;AAC5B,MAAM,OAAO,GAAG,IAAI,GAAG,EAAmB,CAAC;AAC3C,MAAM,OAAO,GAAG,IAAI,GAAG,EAAyB,CAAC;AAEjD,MAAM,UAAU,oBAAoB,CAAC,QAAgB;IACnD,MAAM,cAAc,GAAmB;QACrC,OAAO,EAAE,CAAC,IAAa,EAAE,KAAa,QAAQ,EAAE,EAAE;YAChD,OAAO,CAAC,GAAG,CAAC,EAAE,EAAE,IAAI,CAAC,CAAC;YACtB,OAAO,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC;QAC9B,CAAC;QACD,OAAO,EAAE,CAAC,KAAa,QAAQ,EAAE,EAAE;YACjC,OAAO,OAAO,CAAC,GAAG,CAAC,EAAE,CAAC,IAAI,YAAY,CAAC;QACzC,CAAC;QACD,UAAU,EAAE,CAAC,KAAa,QAAQ,EAAE,EAAE;YACpC,MAAM,IAAI,GAAG,cAAc,CAAC,OAAO,CAAC,EAAE,CAAC,KAAK,MAAM,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,MAAM,CAAC;YACzE,cAAc,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;YAC7B,OAAO,IAAI,CAAC;QACd,CAAC;QACD,YAAY,EAAE,CAAC,OAAgC,EAAE,KAAa,QAAQ,EAAE,EAAE;YACxE,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,CAAC;gBACrB,OAAO,CAAC,GAAG,CAAC,EAAE,EAAE,IAAI,IAAI,EAAE,CAAC,CAAC;YAC9B,CAAC;YACD,OAAO,OAAO,CAAC,GAAG,CAAC,EAAE,CAAE,CAAC,EAAE,CAAC,OAAO,CAAC,CAAC;QACtC,CAAC;KACF,CAAC;IACF,OAAO,cAAc,CAAC;AACxB,CAAC","sourcesContent":["import type { Disposable } from '@blocksuite/global/utils';\nimport { Slot } from '@blocksuite/global/utils';\n\nimport type { DocMode } from '../types.js';\n\nexport interface DocModeService {\n  setMode: (mode: DocMode, docId?: string) => void;\n  getMode: (docId?: string) => DocMode;\n  toggleMode: (docId?: string) => DocMode;\n  onModeChange: (\n    handler: (mode: DocMode) => void,\n    docId?: string\n  ) => Disposable;\n}\n\nconst DEFAULT_MODE = 'page';\nconst modeMap = new Map<string, DocMode>();\nconst slotMap = new Map<string, Slot<DocMode>>();\n\nexport function createDocModeService(curDocId: string) {\n  const docModeService: DocModeService = {\n    setMode: (mode: DocMode, id: string = curDocId) => {\n      modeMap.set(id, mode);\n      slotMap.get(id)?.emit(mode);\n    },\n    getMode: (id: string = curDocId) => {\n      return modeMap.get(id) ?? DEFAULT_MODE;\n    },\n    toggleMode: (id: string = curDocId) => {\n      const mode = docModeService.getMode(id) === 'page' ? 'edgeless' : 'page';\n      docModeService.setMode(mode);\n      return mode;\n    },\n    onModeChange: (handler: (mode: DocMode) => void, id: string = curDocId) => {\n      if (!slotMap.get(id)) {\n        slotMap.set(id, new Slot());\n      }\n      return slotMap.get(id)!.on(handler);\n    },\n  };\n  return docModeService;\n}\n"]}