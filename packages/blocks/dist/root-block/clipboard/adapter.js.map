{"version":3,"file":"adapter.js","sourceRoot":"","sources":["../../../src/root-block/clipboard/adapter.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,YAAY,EAAE,MAAM,0BAA0B,CAAC;AAiBxD,OAAO,EAAE,WAAW,EAAE,MAAM,mBAAmB,CAAC;AAEhD,OAAO,EAAE,oBAAoB,EAAE,oBAAoB,EAAE,MAAM,YAAY,CAAC;AAQxE,MAAM,OAAO,gBAAiB,SAAQ,WAAmB;aAChD,SAAI,GAAG,qBAAqB,CAAC;IAE3B,eAAe,CACtB,QAAgC;QAEhC,MAAM,IAAI,KAAK,CAAC,iBAAiB,CAAC,CAAC;IACrC,CAAC;IAEQ,aAAa,CACpB,QAAsC;QAEtC,MAAM,IAAI,KAAK,CAAC,iBAAiB,CAAC,CAAC;IACrC,CAAC;IAEQ,iBAAiB,CACxB,QAAkC;QAElC,MAAM,IAAI,KAAK,CAAC,iBAAiB,CAAC,CAAC;IACrC,CAAC;IAEQ,eAAe,CACtB,QAAwC;QAExC,MAAM,IAAI,KAAK,CAAC,iBAAiB,CAAC,CAAC;IACrC,CAAC;IAEQ,KAAK,CAAC,iBAAiB,CAC9B,OAAiC;QAEjC,MAAM,QAAQ,GAAG,OAAO,CAAC,QAAQ,CAAC;QAClC,MAAM,MAAM,GAAG,OAAO,CAAC,MAAM,CAAC;QAC9B,YAAY,CAAC,MAAM,CAAC,CAAC;QACrB,MAAM,GAAG,GAAG,MAAM,CAAC,SAAS,EAAE,CAAC;QAC/B,MAAM,KAAK,GAAiC,MAAM,oBAAoB,CAAC,GAAG,CAAC,CAAC;QAC5E,OAAO;YACL,IAAI,EAAE,IAAI,CAAC,SAAS,CAAC;gBACnB,QAAQ;gBACR,KAAK;aACN,CAAC;YACF,SAAS,EAAE,EAAE;SACd,CAAC;IACJ,CAAC;IAEQ,eAAe,CACtB,OAAuC;QAEvC,MAAM,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;QACtC,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,IAAI,CAAC;QACjC,MAAM,GAAG,GAAG,OAAO,CAAC,MAAM,EAAE,SAAS,EAAE,CAAC;QACxC,oBAAoB,CAAC,KAAK,EAAE,GAAG,CAAC,CAAC;QACjC,OAAO,OAAO,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;IACnC,CAAC","sourcesContent":["import { assertExists } from '@blocksuite/global/utils';\nimport type {\n  FromBlockSnapshotPayload,\n  FromBlockSnapshotResult,\n  FromDocSnapshotPayload,\n  FromDocSnapshotResult,\n  FromSliceSnapshotPayload,\n  FromSliceSnapshotResult,\n  ToBlockSnapshotPayload,\n  ToDocSnapshotPayload,\n  ToSliceSnapshotPayload,\n} from '@blocksuite/store';\nimport type {\n  BlockSnapshot,\n  DocSnapshot,\n  SliceSnapshot,\n} from '@blocksuite/store';\nimport { BaseAdapter } from '@blocksuite/store';\n\nimport { decodeClipboardBlobs, encodeClipboardBlobs } from './utils.js';\n\nexport type FileSnapshot = {\n  name: string;\n  type: string;\n  content: string;\n};\n\nexport class ClipboardAdapter extends BaseAdapter<string> {\n  static MIME = 'BLOCKSUITE/SNAPSHOT';\n\n  override fromDocSnapshot(\n    _payload: FromDocSnapshotPayload\n  ): Promise<FromDocSnapshotResult<string>> {\n    throw new Error('not implemented');\n  }\n\n  override toDocSnapshot(\n    _payload: ToDocSnapshotPayload<string>\n  ): Promise<DocSnapshot> {\n    throw new Error('not implemented');\n  }\n\n  override fromBlockSnapshot(\n    _payload: FromBlockSnapshotPayload\n  ): Promise<FromBlockSnapshotResult<string>> {\n    throw new Error('not implemented');\n  }\n\n  override toBlockSnapshot(\n    _payload: ToBlockSnapshotPayload<string>\n  ): Promise<BlockSnapshot> {\n    throw new Error('not implemented');\n  }\n\n  override async fromSliceSnapshot(\n    payload: FromSliceSnapshotPayload\n  ): Promise<FromSliceSnapshotResult<string>> {\n    const snapshot = payload.snapshot;\n    const assets = payload.assets;\n    assertExists(assets);\n    const map = assets.getAssets();\n    const blobs: Record<string, FileSnapshot> = await encodeClipboardBlobs(map);\n    return {\n      file: JSON.stringify({\n        snapshot,\n        blobs,\n      }),\n      assetsIds: [],\n    };\n  }\n\n  override toSliceSnapshot(\n    payload: ToSliceSnapshotPayload<string>\n  ): Promise<SliceSnapshot> {\n    const json = JSON.parse(payload.file);\n    const { blobs, snapshot } = json;\n    const map = payload.assets?.getAssets();\n    decodeClipboardBlobs(blobs, map);\n    return Promise.resolve(snapshot);\n  }\n}\n"]}