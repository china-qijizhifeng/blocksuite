{"version":3,"file":"index.js","sourceRoot":"","sources":["../../../../src/root-block/widgets/edgeless-copilot-panel/index.ts"],"names":[],"mappings":"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","sourcesContent":["import '../../../_common/components/ai-item/ai-item-list.js';\n\nimport type { EditorHost } from '@blocksuite/block-std';\nimport { WithDisposable } from '@blocksuite/block-std';\nimport { css, html, LitElement, nothing } from 'lit';\nimport { customElement, property } from 'lit/decorators.js';\n\nimport type { AIItemGroupConfig } from '../../../_common/components/ai-item/types.js';\nimport { scrollbarStyle } from '../../../_common/components/utils.js';\nimport { on, stopPropagation } from '../../../_common/utils/event.js';\nimport type { EdgelessRootBlockComponent } from '../../edgeless/edgeless-root-block.js';\n\n@customElement('edgeless-copilot-panel')\nexport class EdgelessCopilotPanel extends WithDisposable(LitElement) {\n  static override styles = css`\n    :host {\n      display: flex;\n      position: absolute;\n    }\n\n    .edgeless-copilot-panel {\n      box-sizing: border-box;\n      padding: 8px 4px 8px 8px;\n      min-width: 330px;\n      max-height: 374px;\n      overflow-y: auto;\n      background: var(--affine-background-overlay-panel-color);\n      box-shadow: var(--affine-shadow-2);\n      border-radius: 8px;\n      z-index: var(--affine-z-index-popover);\n    }\n\n    ${scrollbarStyle('.edgeless-copilot-panel')}\n    .edgeless-copilot-panel:hover::-webkit-scrollbar-thumb {\n      background-color: var(--affine-black-30);\n    }\n  `;\n\n  @property({ attribute: false })\n  accessor host!: EditorHost;\n\n  @property({ attribute: false })\n  accessor edgeless!: EdgelessRootBlockComponent;\n\n  @property({ attribute: false })\n  accessor groups!: AIItemGroupConfig[];\n\n  @property({ attribute: false })\n  accessor entry: 'toolbar' | 'selection' | undefined = undefined;\n\n  @property({ attribute: false })\n  accessor onClick: (() => void) | undefined = undefined;\n\n  private _getChain() {\n    return this.edgeless.service.std.command.chain();\n  }\n\n  override connectedCallback(): void {\n    super.connectedCallback();\n    this._disposables.add(on(this, 'wheel', stopPropagation));\n    this._disposables.add(on(this, 'pointerdown', stopPropagation));\n  }\n\n  hide() {\n    this.remove();\n  }\n\n  override render() {\n    const chain = this._getChain();\n    const groups = this.groups.reduce((pre, group) => {\n      const filtered = group.items.filter(item =>\n        item.showWhen?.(chain, 'edgeless', this.host)\n      );\n\n      if (filtered.length > 0) pre.push({ ...group, items: filtered });\n\n      return pre;\n    }, [] as AIItemGroupConfig[]);\n\n    if (groups.every(group => group.items.length === 0)) return nothing;\n\n    return html`\n      <div class=\"edgeless-copilot-panel\">\n        <ai-item-list\n          .onClick=${() => {\n            this.onClick?.();\n          }}\n          .host=${this.host}\n          .groups=${groups}\n        ></ai-item-list>\n      </div>\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'edgeless-copilot-panel': EdgelessCopilotPanel;\n  }\n}\n"]}