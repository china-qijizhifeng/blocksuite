{"version":3,"file":"toolbar-entry.js","sourceRoot":"","sources":["../../../../src/root-block/widgets/edgeless-copilot-panel/toolbar-entry.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,OAAO,EAAmB,cAAc,EAAE,MAAM,uBAAuB,CAAC;AACxE,OAAO,EAAE,GAAG,EAAE,IAAI,EAAE,UAAU,EAAE,MAAM,KAAK,CAAC;AAC5C,OAAO,EAAE,aAAa,EAAE,QAAQ,EAAE,MAAM,mBAAmB,CAAC;AAG5D,OAAO,EAAE,UAAU,EAAE,MAAM,8BAA8B,CAAC;AAC1D,OAAO,EAAE,qBAAqB,EAAE,MAAM,8CAA8C,CAAC;AAGrF,OAAO,EAAE,YAAY,EAAE,MAAM,+BAA+B,CAAC;IAGhD,2BAA2B;4BADvC,aAAa,CAAC,gCAAgC,CAAC;;;;sBACC,cAAc,CAAC,UAAU,CAAC;;;;;;;;;;2CAAlC,SAAQ,WAA0B;;;;gCAWxE,QAAQ,CAAC,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC;oCAG9B,QAAQ,CAAC,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC;kCAG9B,QAAQ,CAAC,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC;YAL/B,iKAAS,IAAI,6BAAJ,IAAI,mFAAc;YAG3B,6KAAS,QAAQ,6BAAR,QAAQ,2FAA8B;YAG/C,uKAAS,MAAM,6BAAN,MAAM,uFAAuB;YAlBxC,6KAkDC;;;;iBAjDiB,WAAM,GAAG,GAAG,CAAA;;;;;;;;GAQ3B,AARqB,CAQpB;QAGF,6EAA2B;QAA3B,IAAS,IAAI,0CAAc;QAA3B,IAAS,IAAI,gDAAc;QAG3B,yIAA+C;QAA/C,IAAS,QAAQ,8CAA8B;QAA/C,IAAS,QAAQ,oDAA8B;QAG/C,yIAAsC;QAAtC,IAAS,MAAM,4CAAuB;QAAtC,IAAS,MAAM,kDAAuB;QAE9B,iBAAiB;YACvB,MAAM,gBAAgB,GAAG,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,SAAS,CAAC,gBAAgB,CAAC;YAC1E,MAAM,YAAY,GAAG,IAAI,GAAG,CAAC,gBAAgB,CAAC,CAAC;YAC/C,gBAAgB,CAAC,OAAO,CAAC,OAAO,CAAC,EAAE;gBACjC,IAAI,YAAY,CAAC,OAAO,CAAC,EAAE,CAAC;oBAC1B,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,KAAK;yBACxB,kBAAkB,CAAC,OAAO,CAAC;yBAC3B,OAAO,CAAC,GAAG,CAAC,EAAE,CAAC,YAAY,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC;gBAC3C,CAAC;qBAAM,IAAI,OAAO,YAAY,qBAAqB,EAAE,CAAC;oBACpD,OAAO,CAAC,WAAW,EAAE,CAAC,OAAO,CAAC,GAAG,CAAC,EAAE,CAAC,YAAY,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC;gBAC9D,CAAC;YACH,CAAC,CAAC,CAAC;YAEH,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC;gBACzC,IAAI,EAAE,SAAS;aAChB,CAAC,CAAC;YAED,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,WAAW,CAAC,SAAS,CAC1C,CAAC,mBAAmB,CAAC,KAAK,CAAC,IAAI,CAAC,YAAY,CAAC,EAAE,EAAE,CAAC,CAAC;QACtD,CAAC;QAEQ,MAAM;YACb,OAAO,IAAI,CAAA;;;eAGA,IAAI,CAAC,iBAAiB;;QAE7B,UAAU;iCACe,CAAC;QAChC,CAAC;;;;;;YAjDU,uDAA2B;;;;;SAA3B,2BAA2B","sourcesContent":["import { type EditorHost, WithDisposable } from '@blocksuite/block-std';\nimport { css, html, LitElement } from 'lit';\nimport { customElement, property } from 'lit/decorators.js';\n\nimport type { AIItemGroupConfig } from '../../../_common/components/ai-item/types.js';\nimport { AIStarIcon } from '../../../_common/icons/ai.js';\nimport { SurfaceGroupLikeModel } from '../../../surface-block/element-model/base.js';\nimport type { CopilotSelectionController } from '../../edgeless/controllers/tools/copilot-tool.js';\nimport type { EdgelessRootBlockComponent } from '../../edgeless/edgeless-root-block.js';\nimport { isFrameBlock } from '../../edgeless/utils/query.js';\n\n@customElement('edgeless-copilot-toolbar-entry')\nexport class EdgelessCopilotToolbarEntry extends WithDisposable(LitElement) {\n  static override styles = css`\n    .copilot-icon-button {\n      line-height: 20px;\n\n      .label.medium {\n        color: var(--affine-brand-color);\n      }\n    }\n  `;\n\n  @property({ attribute: false })\n  accessor host!: EditorHost;\n\n  @property({ attribute: false })\n  accessor edgeless!: EdgelessRootBlockComponent;\n\n  @property({ attribute: false })\n  accessor groups!: AIItemGroupConfig[];\n\n  private _showCopilotPanel() {\n    const selectedElements = this.edgeless.service.selection.selectedElements;\n    const toBeSelected = new Set(selectedElements);\n    selectedElements.forEach(element => {\n      if (isFrameBlock(element)) {\n        this.edgeless.service.frame\n          .getElementsInFrame(element)\n          .forEach(ele => toBeSelected.add(ele));\n      } else if (element instanceof SurfaceGroupLikeModel) {\n        element.descendants().forEach(ele => toBeSelected.add(ele));\n      }\n    });\n\n    this.edgeless.service.tool.setEdgelessTool({\n      type: 'copilot',\n    });\n    (\n      this.edgeless.tools.controllers['copilot'] as CopilotSelectionController\n    ).updateSelectionWith(Array.from(toBeSelected), 10);\n  }\n\n  override render() {\n    return html`<edgeless-tool-icon-button\n      aria-label=\"Ask AI\"\n      class=\"copilot-icon-button\"\n      @click=${this._showCopilotPanel}\n    >\n      ${AIStarIcon} <span class=\"label medium\">Ask AI</span>\n    </edgeless-tool-icon-button>`;\n  }\n}\n"]}