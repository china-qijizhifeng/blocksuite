{"version":3,"file":"block-hub.js","sourceRoot":"","sources":["../../../../../src/root-block/widgets/block-hub/components/block-hub.ts"],"names":[],"mappings":"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","sourcesContent":["import type { EditorHost } from '@blocksuite/block-std';\nimport { ShadowlessElement, WithDisposable } from '@blocksuite/block-std';\nimport { IS_FIREFOX } from '@blocksuite/global/env';\nimport { assertExists } from '@blocksuite/global/utils';\nimport { html } from 'lit';\nimport { customElement, query, queryAll, state } from 'lit/decorators.js';\nimport { classMap } from 'lit/directives/class-map.js';\n\nimport type { DragIndicator } from '../../../../_common/components/drag-indicator.js';\nimport { toggleEmbedCardCreateModal } from '../../../../_common/components/embed-card/modal/index.js';\nimport { BlockHubIcon, CrossIcon } from '../../../../_common/icons/index.js';\nimport {\n  asyncFocusRichText,\n  buildPath,\n  calcDropTarget,\n  type DroppingType,\n  type EditingState,\n  getClosestBlockElementByPoint,\n  getEdgelessRootByEditorHost,\n  getHoveringNote,\n  getImageFilesFromLocal,\n  getModelByBlockComponent,\n  getPageRootByEditorHost,\n  isInsidePageEditor,\n  Point,\n  Rect,\n  stopPropagation,\n} from '../../../../_common/utils/index.js';\nimport { viewPresets } from '../../../../database-block/data-view/index.js';\nimport {\n  addImageBlocks,\n  addSiblingImageBlock,\n} from '../../../../image-block/utils.js';\nimport type { EdgelessRootBlockComponent } from '../../../../root-block/edgeless/edgeless-root-block.js';\nimport { PageRootBlockComponent } from '../../../../root-block/page/page-root-block.js';\nimport { autoScroll } from '../../../../root-block/text-selection/utils.js';\nimport { getClosestNoteBlock } from '../../drag-handle/utils.js';\nimport {\n  BlockHubMenu,\n  type CardListType,\n} from './../components/block-hub-menu.js';\nimport {\n  BOTTOM_OFFSET,\n  RIGHT_OFFSET,\n  TOP_DISTANCE,\n  TRANSITION_DELAY,\n} from './../config.js';\nimport { styles } from './../styles.js';\n\n@customElement('affine-block-hub')\nexport class BlockHub extends WithDisposable(ShadowlessElement) {\n  private get _rootElement() {\n    const rootElement = isInsidePageEditor(this._editorHost)\n      ? (getPageRootByEditorHost(this._editorHost) as PageRootBlockComponent)\n      : (getEdgelessRootByEditorHost(\n          this._editorHost\n        ) as EdgelessRootBlockComponent);\n    return rootElement;\n  }\n\n  static override styles = styles;\n\n  /**\n   * A function that returns all blocks that are allowed to be moved to\n   */\n  @state()\n  private accessor _expanded = false;\n\n  @state()\n  private accessor _isGrabbing = false;\n\n  @state()\n  private accessor _visibleCardType: CardListType | null = null;\n\n  @state()\n  private accessor _showTooltip = true;\n\n  @state()\n  private accessor _maxHeight = 2000;\n\n  @queryAll('.card-container')\n  private accessor _blockHubCards!: NodeList & HTMLElement[];\n\n  @queryAll('.block-hub-icon-container[type]')\n  private accessor _blockHubMenus!: NodeList & HTMLElement[];\n\n  @query('.new-icon')\n  private accessor _blockHubButton!: HTMLElement;\n\n  @query('.block-hub-icons-container')\n  private accessor _blockHubIconsContainer!: HTMLElement;\n\n  @query('.block-hub-menu-container')\n  private accessor _blockHubMenuContainer!: HTMLElement;\n\n  @query('[role=\"menuitem\"]')\n  private accessor _blockHubMenuEntry!: HTMLElement;\n\n  private _currentClientX = 0;\n\n  private _currentClientY = 0;\n\n  private _isCardListVisible = false;\n\n  private _indicator!: DragIndicator;\n\n  private _lastDroppingTarget: EditingState | null = null;\n\n  private _lastDroppingType: DroppingType = 'none';\n\n  private _lastDraggingFlavour: string | null = null;\n\n  private _timer: number | null = null;\n\n  private _rafID: number = 0;\n\n  private _editorHost: EditorHost;\n\n  constructor(host: EditorHost) {\n    super();\n    this._editorHost = host;\n  }\n\n  private _getHoveringNoteState = (point: Point) => {\n    const state = {\n      scale: 1,\n    } as {\n      container?: Element;\n      rect?: Rect;\n      scale: number;\n    };\n\n    if (isInsidePageEditor(this._editorHost)) {\n      const closestNoteBlock = getClosestNoteBlock(\n        this._editorHost,\n        this._rootElement,\n        point\n      );\n      if (closestNoteBlock) {\n        state.rect = Rect.fromDOMRect(closestNoteBlock.getBoundingClientRect());\n      }\n    } else {\n      state.scale = (\n        this._rootElement as EdgelessRootBlockComponent\n      ).service.viewport.zoom;\n      const container = getHoveringNote(point);\n      if (container) {\n        state.rect = Rect.fromDOM(container);\n        state.container = container;\n      }\n    }\n    return state;\n  };\n\n  /**\n   * This is currently a workaround, as the height of the _blockHubIconsContainer is determined by the height of its\n   * content, and if its child's opacity is set to 0 during a transition, its height won't change, causing the background\n   * to exceeds its actual visual height. So currently we manually set the height of those whose opacity is 0 to 0px.\n   */\n  private _onTransitionStart = (_: TransitionEvent) => {\n    if (this._timer) {\n      clearTimeout(this._timer);\n    }\n    if (!this._expanded) {\n      // when the _blockHubMenuContainer is unexpanded, should cancel the vertical padding making it a square\n      this._blockHubMenuContainer.style.padding = '0 4px';\n      this._timer = window.setTimeout(() => {\n        this._blockHubIconsContainer.style.overflow = 'hidden';\n      }, TRANSITION_DELAY);\n    } else {\n      this._blockHubMenuContainer.style.padding = '4px';\n      this._timer = window.setTimeout(() => {\n        this._blockHubIconsContainer.style.overflow = 'unset';\n      }, TRANSITION_DELAY);\n    }\n  };\n\n  private _hideCardList() {\n    if (this._visibleCardType) {\n      this._visibleCardType = null;\n      this._isCardListVisible = false;\n    }\n  }\n\n  private _onBlockHubButtonClick = (_: MouseEvent) => {\n    this._expanded = !this._expanded;\n    if (!this._expanded) {\n      this._hideCardList();\n    }\n  };\n\n  private _clearRaf() {\n    if (this._rafID) {\n      cancelAnimationFrame(this._rafID);\n      this._rafID = 0;\n    }\n  }\n\n  private _onMouseDown = (e: MouseEvent) => {\n    if (IS_FIREFOX) {\n      this._currentClientX = e.clientX;\n      this._currentClientY = e.clientY;\n    }\n  };\n\n  private _onDragStart = (event: DragEvent) => {\n    this._showTooltip = false;\n    // DragEvent that doesn't dispatch manually, is expected to have dataTransfer property\n    assertExists(event.dataTransfer);\n    event.dataTransfer.effectAllowed = 'move';\n    const blockHubElement = event.target as HTMLElement;\n    const data: {\n      flavour: string | null;\n      type?: string;\n    } = {\n      flavour: blockHubElement.getAttribute('affine-flavour'),\n      type: blockHubElement.getAttribute('affine-type') ?? undefined,\n    };\n    event.dataTransfer.setData('affine/block-hub', JSON.stringify(data));\n    this._lastDraggingFlavour = data.flavour;\n    this._rootElement.selection.clear();\n  };\n\n  private _onDrag = (e: DragEvent) => {\n    this._hideCardList();\n    let x = e.clientX;\n    let y = e.clientY;\n    if (IS_FIREFOX) {\n      // In Firefox, `pageX` and `pageY` are always set to 0.\n      // Refs: https://stackoverflow.com/questions/13110349/pagex-and-pagey-are-always-set-to-0-in-firefox-during-the-ondrag-event.\n      x = this._currentClientX;\n      y = this._currentClientY;\n    }\n\n    if (\n      !this._indicator ||\n      (this._indicator.rect &&\n        this._indicator.rect.left === x &&\n        this._indicator.rect.top === y)\n    ) {\n      return;\n    }\n\n    const point = new Point(x, y);\n    const {\n      container,\n      rect: noteRect,\n      scale,\n    } = this._getHoveringNoteState(point.clone());\n\n    if (!noteRect) {\n      this._resetDropState();\n      return;\n    }\n\n    let element: Element | null = null;\n    element = getClosestBlockElementByPoint(\n      point,\n      { container, rect: noteRect, snapToEdge: { x: false, y: true } },\n      scale\n    );\n\n    if (!element) {\n      const { min, max } = noteRect;\n      if (x >= min.x && x <= max.x && y >= min.y) {\n        const lastBlock = this._rootElement.model.lastChild();\n        if (lastBlock) {\n          const lastElement = this._editorHost.view.viewFromPath('block', [\n            lastBlock.id,\n          ]);\n          element = lastElement;\n        }\n      }\n    }\n\n    if (!element) {\n      // if (this._mouseRoot.mode === 'page') {\n      //   return;\n      // }\n      this._resetDropState();\n      return;\n    }\n\n    let type: DroppingType = 'none';\n    let rect = null;\n    let lastModelState = null;\n    const model = getModelByBlockComponent(element);\n    const result = calcDropTarget(\n      point,\n      model,\n      element,\n      [],\n      scale,\n      this._lastDraggingFlavour\n    );\n\n    if (result) {\n      type = result.type;\n      rect = result.rect;\n      lastModelState = result.modelState;\n    }\n\n    const runner = () => {\n      // only support auto scroll in page mode now\n      if (this._rootElement instanceof PageRootBlockComponent) {\n        const result = autoScroll(\n          this._rootElement.rootScrollContainer,\n          point.y\n        );\n        if (!result) {\n          this._clearRaf();\n          return;\n        }\n        this._rafID = requestAnimationFrame(runner);\n      } else {\n        this._clearRaf();\n      }\n    };\n\n    this._rafID = requestAnimationFrame(runner);\n    this._lastDroppingType = type;\n    this._indicator.rect = rect;\n    this._lastDroppingTarget = lastModelState;\n  };\n\n  private _onDragOver = (e: DragEvent) => {\n    e.preventDefault();\n    return false;\n  };\n\n  private _onDragOverDocument = (e: DragEvent) => {\n    if (!IS_FIREFOX) {\n      throw new Error('FireFox only');\n    }\n    this._currentClientX = e.clientX;\n    this._currentClientY = e.clientY;\n  };\n\n  private _onDragEnd = (_: DragEvent) => {\n    this._showTooltip = true;\n    this._isGrabbing = false;\n    this._lastDraggingFlavour = null;\n    this._resetDropState();\n  };\n\n  private _resetDropState = () => {\n    this._lastDroppingType = 'none';\n    this._indicator.rect = null;\n    this._lastDroppingTarget = null;\n  };\n\n  private _onDrop = async (e: DragEvent) => {\n    assertExists(e.dataTransfer);\n    if (!e.dataTransfer.getData('affine/block-hub')) return;\n\n    const doc = this._editorHost.doc;\n    const point = this._indicator?.rect?.min ?? new Point(e.clientX, e.clientY);\n    const lastModelState = this._lastDroppingTarget;\n    const lastType = this._lastDroppingType;\n    const dataTransfer = e.dataTransfer;\n    assertExists(dataTransfer);\n\n    const data = dataTransfer.getData('affine/block-hub');\n    const models = [];\n    const props = JSON.parse(data);\n    const isDatabase = props.flavour === 'affine:database';\n\n    // TO DO: fix image loading state for block hub\n    if (\n      props.flavour === 'affine:image' &&\n      props.type === 'image' &&\n      lastModelState &&\n      lastType !== 'none' &&\n      lastType !== 'database'\n    ) {\n      const imageFiles = await getImageFilesFromLocal();\n\n      const imageService = this._editorHost.spec.getService('affine:image');\n      const maxFileSize = imageService.maxFileSize;\n\n      addSiblingImageBlock(\n        this._editorHost,\n        imageFiles,\n        maxFileSize,\n        lastModelState.model\n      );\n    } else if (props.flavour === 'affine:bookmark') {\n      if (lastModelState && lastType !== 'none' && lastType !== 'database') {\n        const model = lastModelState.model;\n        const parentModel = doc.getParent(model);\n        assertExists(parentModel);\n\n        const index =\n          parentModel.children.indexOf(model) + (lastType === 'after' ? 1 : 0);\n        await toggleEmbedCardCreateModal(\n          this._editorHost,\n          'Links',\n          'The added link will be displayed as a card view.',\n          {\n            mode: 'page',\n            parentModel,\n            index,\n          }\n        );\n      }\n    } else {\n      models.push(props);\n    }\n\n    // In some cases, like cancel bookmark initial modal, there will be no models.\n    if (!models.length) return;\n\n    let parentModel;\n    let focusId;\n    if (lastModelState && lastType !== 'none') {\n      const { model } = lastModelState;\n\n      doc.captureSync();\n\n      if (lastType === 'database') {\n        const ids = doc.addBlocks(models, model);\n        focusId = ids[0];\n        parentModel = model;\n      } else {\n        const parent = doc.getParent(model);\n        assertExists(parent);\n        const ids = doc.addSiblingBlocks(model, models, lastType);\n        focusId = ids[0];\n        parentModel = parent;\n      }\n\n      // database init basic structure\n      if (isDatabase) {\n        const service =\n          this._rootElement.std.spec?.getService('affine:database');\n        service.initDatabaseBlock(\n          doc,\n          model,\n          model.id,\n          viewPresets.tableViewConfig\n        );\n      }\n    }\n\n    if (isInsidePageEditor(this._editorHost)) {\n      if (focusId) {\n        asyncFocusRichText(this._editorHost, focusId)?.catch(console.error);\n      }\n      return;\n    }\n\n    // In edgeless mode.\n    const rootElement = this._rootElement as EdgelessRootBlockComponent;\n\n    let noteId;\n    if (focusId && parentModel) {\n      const targetNoteBlock = this._editorHost.view.viewFromPath(\n        'block',\n        buildPath(parentModel)\n      );\n      assertExists(targetNoteBlock);\n      noteId = targetNoteBlock.model.id;\n    } else {\n      // Creates new note block on blank area.\n      const result = rootElement.addNewNote(\n        models,\n        point,\n        isDatabase ? { width: 752 } : undefined\n      );\n      noteId = result.noteId;\n      focusId = result.ids[0];\n      const model = doc.getBlockById(focusId);\n      assertExists(model);\n      if (isDatabase) {\n        const service = rootElement.std.spec?.getService('affine:database');\n        service.initDatabaseBlock(\n          doc,\n          model,\n          model.id,\n          viewPresets.kanbanViewConfig\n        );\n      }\n    }\n    rootElement.setSelection(noteId, true, focusId, point);\n  };\n\n  private _onClickCard = async (\n    _: MouseEvent,\n    blockHubElement: HTMLElement\n  ) => {\n    const affineType = blockHubElement.getAttribute('affine-type');\n    assertExists(affineType);\n    const data: {\n      flavour: string;\n      type?: string;\n    } = {\n      flavour: blockHubElement.getAttribute('affine-flavour') ?? '',\n      type: affineType ?? undefined,\n    };\n    const doc = this._editorHost.doc;\n    const models = [];\n\n    const defaultNoteBlock =\n      doc.root?.children.findLast(block => block.flavour === 'affine:note') ??\n      doc.addBlock('affine:note', {}, doc.root?.id);\n\n    // add to end\n    let lastId;\n\n    // TO DO: fix image loading state for blockhub\n    if (data.flavour === 'affine:image' && data.type === 'image') {\n      const imageFiles = await getImageFilesFromLocal();\n\n      const imageService = this._editorHost.spec.getService('affine:image');\n      const maxFileSize = imageService.maxFileSize;\n\n      const blockIds = addImageBlocks(\n        this._editorHost,\n        imageFiles,\n        maxFileSize,\n        defaultNoteBlock\n      );\n\n      lastId = blockIds?.[blockIds.length - 1];\n    } else if (data.flavour === 'affine:bookmark') {\n      await toggleEmbedCardCreateModal(\n        this._editorHost,\n        'Links',\n        'The added link will be displayed as a card view.',\n        {\n          mode: 'page',\n          parentModel: defaultNoteBlock,\n        }\n      );\n    } else {\n      models.push(data);\n    }\n\n    models.forEach(model => {\n      lastId = doc.addBlock(\n        (model.flavour ?? 'affine:paragraph') as never,\n        model,\n        defaultNoteBlock\n      );\n    });\n    lastId && (await asyncFocusRichText(this._editorHost, lastId));\n  };\n\n  private _onClickOutside = (e: MouseEvent) => {\n    const target = e.target;\n    if (target instanceof HTMLElement && !target.closest('affine-block-hub')) {\n      this._hideCardList();\n    }\n  };\n\n  private _onCardMouseDown = (_: Event) => {\n    this._isGrabbing = true;\n  };\n\n  private _onCardMouseUp = (_: Event) => {\n    this._isGrabbing = false;\n  };\n\n  private _onBlankMenuMouseDown = () => {\n    this._isGrabbing = true;\n  };\n\n  private _onBlankMenuMouseUp = () => {\n    this._isGrabbing = false;\n  };\n\n  private _onBlockHubMenuMouseOver = (e: Event) => {\n    const menu = e.currentTarget as HTMLElement;\n    const cardType = menu.getAttribute('type');\n    assertExists(cardType);\n    this._isCardListVisible = true;\n    this._visibleCardType = cardType as CardListType;\n  };\n\n  private _onBlockHubEntryMouseOver = () => {\n    this._isCardListVisible = false;\n  };\n\n  private _onResize = () => {\n    const boundingClientRect = document.body.getBoundingClientRect();\n    this._maxHeight = boundingClientRect.height - TOP_DISTANCE - BOTTOM_OFFSET;\n  };\n\n  override connectedCallback() {\n    super.connectedCallback();\n\n    const disposables = this._disposables;\n    disposables.addFromEvent(this, 'dragstart', this._onDragStart);\n    disposables.addFromEvent(this, 'drag', this._onDrag);\n    disposables.addFromEvent(this, 'dragend', this._onDragEnd);\n    disposables.addFromEvent(this._editorHost, 'dragover', this._onDragOver);\n    disposables.addFromEvent(this._editorHost, 'drop', (e: DragEvent) => {\n      this._onDrop(e).catch(console.error);\n    });\n    disposables.addFromEvent(this, 'mousedown', this._onMouseDown);\n\n    if (IS_FIREFOX) {\n      disposables.addFromEvent(\n        this._editorHost,\n        'dragover',\n        this._onDragOverDocument\n      );\n    }\n\n    this._onResize();\n  }\n\n  override firstUpdated() {\n    const disposables = this._disposables;\n    this._blockHubCards.forEach((card: HTMLElement) => {\n      disposables.addFromEvent(card, 'mousedown', this._onCardMouseDown);\n      disposables.addFromEvent(card, 'mouseup', this._onCardMouseUp);\n      disposables.addFromEvent(card, 'click', e => {\n        this._onClickCard(e, card).catch(console.error);\n      });\n    });\n\n    for (const blockHubMenu of this._blockHubMenus) {\n      disposables.addFromEvent(\n        blockHubMenu,\n        'mouseover',\n        this._onBlockHubMenuMouseOver\n      );\n      if (blockHubMenu.getAttribute('type') === 'blank') {\n        disposables.addFromEvent(\n          blockHubMenu,\n          'mousedown',\n          this._onBlankMenuMouseDown\n        );\n        disposables.addFromEvent(\n          blockHubMenu,\n          'mouseup',\n          this._onBlankMenuMouseUp\n        );\n      }\n    }\n\n    disposables.addFromEvent(\n      this._blockHubMenuEntry,\n      'mouseover',\n      this._onBlockHubEntryMouseOver\n    );\n    disposables.addFromEvent(document, 'click', this._onClickOutside);\n    disposables.addFromEvent(\n      this._blockHubButton,\n      'click',\n      this._onBlockHubButtonClick\n    );\n    disposables.addFromEvent(this._blockHubButton, 'mousedown', e => {\n      // Prevent input from losing focus\n      e.preventDefault();\n    });\n    disposables.addFromEvent(\n      this._blockHubIconsContainer,\n      'transitionstart',\n      this._onTransitionStart\n    );\n    disposables.addFromEvent(window, 'resize', this._onResize);\n\n    this._indicator = document.querySelector(\n      'affine-drag-indicator'\n    ) as DragIndicator;\n    if (!this._indicator) {\n      this._indicator = document.createElement(\n        'affine-drag-indicator'\n      ) as DragIndicator;\n      document.body.append(this._indicator);\n    }\n  }\n\n  override disconnectedCallback() {\n    super.disconnectedCallback();\n    this._disposables.dispose();\n  }\n\n  toggleMenu() {\n    this._expanded = !this._expanded;\n    if (!this._expanded) this._hideCardList();\n  }\n\n  override render() {\n    const blockHubMenu = BlockHubMenu(\n      this._expanded,\n      this._isGrabbing,\n      this._visibleCardType,\n      this._isCardListVisible,\n      this._showTooltip,\n      this._maxHeight\n    );\n\n    const classes = classMap({\n      'icon-expanded': this._expanded,\n      'new-icon-in-edgeless':\n        !isInsidePageEditor(this._editorHost) && !this._expanded,\n      'new-icon': true,\n    });\n\n    return html`\n      <div\n        class=\"block-hub-menu-container\"\n        @pointerdown=${stopPropagation}\n        ?expanded=${this._expanded}\n        style=\"bottom: ${BOTTOM_OFFSET}px; right: ${RIGHT_OFFSET}px;\"\n      >\n        ${blockHubMenu}\n        <div class=${classes} role=\"menuitem\" style=\"cursor:pointer;\">\n          ${this._expanded\n            ? CrossIcon\n            : [\n                BlockHubIcon,\n                html`<affine-tooltip tip-position=\"left\"\n                  >Insert blocks</affine-tooltip\n                >`,\n              ]}\n        </div>\n      </div>\n    `;\n  }\n}\n"]}