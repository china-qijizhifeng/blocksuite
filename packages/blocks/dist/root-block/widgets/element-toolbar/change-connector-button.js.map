{"version":3,"file":"change-connector-button.js","sourceRoot":"","sources":["../../../../src/root-block/widgets/element-toolbar/change-connector-button.ts"],"names":[],"mappings":"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","sourcesContent":["import '../../edgeless/components/buttons/tool-icon-button.js';\nimport '../../edgeless/components/buttons/menu-button.js';\nimport '../../edgeless/components/panel/stroke-style-panel.js';\nimport '../../edgeless/components/panel/color-panel.js';\nimport './change-text-menu.js';\n\nimport { WithDisposable } from '@blocksuite/block-std';\nimport { html, LitElement, nothing, type TemplateResult } from 'lit';\nimport { customElement, property } from 'lit/decorators.js';\nimport { choose } from 'lit/directives/choose.js';\nimport { join } from 'lit/directives/join.js';\nimport { repeat } from 'lit/directives/repeat.js';\n\nimport {\n  AddTextIcon,\n  ConnectorCWithArrowIcon,\n  ConnectorEndpointNoneIcon,\n  ConnectorLWithArrowIcon,\n  ConnectorXWithArrowIcon,\n  FlipDirectionIcon,\n  FrontEndpointArrowIcon,\n  FrontEndpointCircleIcon,\n  FrontEndpointDiamondIcon,\n  FrontEndpointTriangleIcon,\n  GeneralStyleIcon,\n  RearEndpointArrowIcon,\n  RearEndpointCircleIcon,\n  RearEndpointDiamondIcon,\n  RearEndpointTriangleIcon,\n  ScribbledStyleIcon,\n  SmallArrowDownIcon,\n} from '../../../_common/icons/index.js';\nimport type { CssVariableName } from '../../../_common/theme/css-variables.js';\nimport { LineWidth } from '../../../_common/types.js';\nimport { countBy, maxBy } from '../../../_common/utils/iterable.js';\nimport type {\n  ConnectorElementProps,\n  ConnectorLabelProps,\n} from '../../../surface-block/element-model/connector.js';\nimport type { PointStyle } from '../../../surface-block/index.js';\nimport {\n  type ConnectorElementModel,\n  ConnectorEndpoint,\n  ConnectorMode,\n  DEFAULT_FRONT_END_POINT_STYLE,\n  DEFAULT_REAR_END_POINT_STYLE,\n  type StrokeStyle,\n} from '../../../surface-block/index.js';\nimport { renderMenuDivider } from '../../edgeless/components/buttons/menu-button.js';\nimport {\n  type ColorEvent,\n  GET_DEFAULT_LINE_COLOR,\n} from '../../edgeless/components/panel/color-panel.js';\nimport type { LineStyleEvent } from '../../edgeless/components/panel/line-styles-panel.js';\nimport type { EdgelessRootBlockComponent } from '../../edgeless/edgeless-root-block.js';\nimport { mountConnectorLabelEditor } from '../../edgeless/utils/text.js';\n\nfunction getMostCommonColor(\n  elements: ConnectorElementModel[]\n): CssVariableName {\n  const colors = countBy(elements, ele => ele.stroke);\n  const max = maxBy(Object.entries(colors), ([_k, count]) => count);\n  return max ? (max[0] as CssVariableName) : GET_DEFAULT_LINE_COLOR();\n}\n\nfunction getMostCommonMode(\n  elements: ConnectorElementModel[]\n): ConnectorMode | null {\n  const modes = countBy(elements, ele => ele.mode);\n  const max = maxBy(Object.entries(modes), ([_k, count]) => count);\n  return max ? (Number(max[0]) as ConnectorMode) : null;\n}\n\nfunction getMostCommonLineWidth(elements: ConnectorElementModel[]): LineWidth {\n  const sizes = countBy(elements, ele => ele.strokeWidth);\n  const max = maxBy(Object.entries(sizes), ([_k, count]) => count);\n  return max ? (Number(max[0]) as LineWidth) : LineWidth.Four;\n}\n\nexport function getMostCommonLineStyle(\n  elements: ConnectorElementModel[]\n): StrokeStyle | null {\n  const sizes = countBy(elements, ele => ele.strokeStyle);\n  const max = maxBy(Object.entries(sizes), ([_k, count]) => count);\n  return max ? (max[0] as StrokeStyle) : null;\n}\n\nfunction getMostCommonRough(elements: ConnectorElementModel[]): boolean {\n  const { trueCount, falseCount } = elements.reduce(\n    (counts, ele) => {\n      if (ele.rough) {\n        counts.trueCount++;\n      } else {\n        counts.falseCount++;\n      }\n      return counts;\n    },\n    { trueCount: 0, falseCount: 0 }\n  );\n\n  return trueCount > falseCount;\n}\n\nfunction getMostCommonEndpointStyle(\n  elements: ConnectorElementModel[],\n  endpoint: ConnectorEndpoint\n): PointStyle | null {\n  const field =\n    endpoint === ConnectorEndpoint.Front\n      ? 'frontEndpointStyle'\n      : 'rearEndpointStyle';\n  const modes = countBy(elements, ele => ele[field]);\n  const max = maxBy(Object.entries(modes), ([_k, count]) => count);\n  return max ? (max[0] as PointStyle) : null;\n}\n\nfunction notEqual<\n  K extends keyof Omit<ConnectorElementProps, keyof ConnectorLabelProps>,\n>(key: K, value: ConnectorElementProps[K]) {\n  return (element: ConnectorElementModel) => element[key] !== value;\n}\n\ninterface EndpointStyle {\n  value: PointStyle;\n  icon: TemplateResult<1>;\n}\n\nconst STYLE_LIST = [\n  {\n    name: 'General',\n    value: false,\n    icon: GeneralStyleIcon,\n  },\n  {\n    name: 'Scribbled',\n    value: true,\n    icon: ScribbledStyleIcon,\n  },\n] as const;\n\nconst STYLE_CHOOSE: [boolean, () => TemplateResult<1>][] = [\n  [false, () => GeneralStyleIcon],\n  [true, () => ScribbledStyleIcon],\n] as const;\n\nconst FRONT_ENDPOINT_STYLE_LIST: EndpointStyle[] = [\n  {\n    value: 'None',\n    icon: ConnectorEndpointNoneIcon,\n  },\n  {\n    value: 'Arrow',\n    icon: FrontEndpointArrowIcon,\n  },\n  {\n    value: 'Triangle',\n    icon: FrontEndpointTriangleIcon,\n  },\n  {\n    value: 'Circle',\n    icon: FrontEndpointCircleIcon,\n  },\n  {\n    value: 'Diamond',\n    icon: FrontEndpointDiamondIcon,\n  },\n] as const;\n\nconst REAR_ENDPOINT_STYLE_LIST: EndpointStyle[] = [\n  {\n    value: 'Diamond',\n    icon: RearEndpointDiamondIcon,\n  },\n  {\n    value: 'Circle',\n    icon: RearEndpointCircleIcon,\n  },\n  {\n    value: 'Triangle',\n    icon: RearEndpointTriangleIcon,\n  },\n  {\n    value: 'Arrow',\n    icon: RearEndpointArrowIcon,\n  },\n  {\n    value: 'None',\n    icon: ConnectorEndpointNoneIcon,\n  },\n] as const;\n\nconst MODE_LIST = [\n  {\n    name: 'Curve',\n    icon: ConnectorCWithArrowIcon,\n    value: ConnectorMode.Curve,\n  },\n  {\n    name: 'Elbowed',\n    icon: ConnectorXWithArrowIcon,\n    value: ConnectorMode.Orthogonal,\n  },\n  {\n    name: 'Straight',\n    icon: ConnectorLWithArrowIcon,\n    value: ConnectorMode.Straight,\n  },\n] as const;\n\nconst MODE_CHOOSE: [ConnectorMode, () => TemplateResult<1>][] = [\n  [ConnectorMode.Curve, () => ConnectorCWithArrowIcon],\n  [ConnectorMode.Orthogonal, () => ConnectorXWithArrowIcon],\n  [ConnectorMode.Straight, () => ConnectorLWithArrowIcon],\n] as const;\n\n@customElement('edgeless-change-connector-button')\nexport class EdgelessChangeConnectorButton extends WithDisposable(LitElement) {\n  @property({ attribute: false })\n  accessor edgeless!: EdgelessRootBlockComponent;\n\n  @property({ attribute: false })\n  accessor elements: ConnectorElementModel[] = [];\n\n  get doc() {\n    return this.edgeless.doc;\n  }\n\n  get service() {\n    return this.edgeless.service;\n  }\n\n  private _setConnectorProp<\n    K extends keyof Omit<ConnectorElementProps, keyof ConnectorLabelProps>,\n  >(key: K, value: ConnectorElementProps[K]) {\n    this.doc.captureSync();\n    this.elements\n      .filter(notEqual(key, value))\n      .forEach(element =>\n        this.service.updateElement(element.id, { [key]: value })\n      );\n  }\n\n  private _setConnectorMode(mode: ConnectorMode) {\n    this._setConnectorProp('mode', mode);\n  }\n\n  private _setConnectorRough(rough: boolean) {\n    this._setConnectorProp('rough', rough);\n  }\n\n  private _setConnectorColor(stroke: CssVariableName) {\n    this._setConnectorProp('stroke', stroke);\n  }\n\n  private _setConnectorStrokeWidth(strokeWidth: number) {\n    this._setConnectorProp('strokeWidth', strokeWidth);\n  }\n\n  private _setConnectorStrokeStyle(strokeStyle: StrokeStyle) {\n    this._setConnectorProp('strokeStyle', strokeStyle);\n  }\n\n  private _setConnectorStorke({ type, value }: LineStyleEvent) {\n    if (type === 'size') {\n      this._setConnectorStrokeWidth(value);\n      return;\n    }\n    this._setConnectorStrokeStyle(value);\n  }\n\n  private _setConnectorPointStyle(end: ConnectorEndpoint, style: PointStyle) {\n    const props = {\n      [end === ConnectorEndpoint.Front\n        ? 'frontEndpointStyle'\n        : 'rearEndpointStyle']: style,\n    };\n    this.elements.forEach(element =>\n      this.service.updateElement(element.id, { ...props })\n    );\n  }\n\n  private _flipEndpointStyle(\n    frontEndpointStyle: PointStyle,\n    rearEndpointStyle: PointStyle\n  ) {\n    if (frontEndpointStyle === rearEndpointStyle) return;\n\n    this.elements.forEach(element =>\n      this.service.updateElement(element.id, {\n        frontEndpointStyle: rearEndpointStyle,\n        rearEndpointStyle: frontEndpointStyle,\n      })\n    );\n  }\n\n  private _getEndpointIcon(list: EndpointStyle[], style: PointStyle) {\n    return (\n      list.find(({ value }) => value === style)?.icon ||\n      ConnectorEndpointNoneIcon\n    );\n  }\n\n  private _addLabel() {\n    mountConnectorLabelEditor(this.elements[0], this.edgeless);\n  }\n\n  private _showAddButtonOrTextMenu() {\n    if (this.elements.length === 1 && !this.elements[0].text) {\n      return 'button';\n    }\n    if (!this.elements.some(e => !e.text)) {\n      return 'menu';\n    }\n    return 'nothing';\n  }\n\n  override render() {\n    const selectedColor = getMostCommonColor(this.elements);\n    const selectedMode = getMostCommonMode(this.elements);\n    const selectedLineSize =\n      getMostCommonLineWidth(this.elements) ?? LineWidth.Four;\n    const selectedRough = getMostCommonRough(this.elements);\n    const selectedLineStyle = getMostCommonLineStyle(this.elements);\n    const selectedStartPointStyle =\n      getMostCommonEndpointStyle(this.elements, ConnectorEndpoint.Front) ??\n      DEFAULT_FRONT_END_POINT_STYLE;\n    const selectedEndPointStyle =\n      getMostCommonEndpointStyle(this.elements, ConnectorEndpoint.Rear) ??\n      DEFAULT_REAR_END_POINT_STYLE;\n\n    return join(\n      [\n        html`\n          <edgeless-menu-button\n            .contentPadding=${'8px'}\n            .button=${html`\n              <edgeless-tool-icon-button\n                aria-label=\"Stroke style\"\n                .tooltip=${'Stroke style'}\n              >\n                <edgeless-color-button\n                  .color=${selectedColor}\n                ></edgeless-color-button>\n              </edgeless-tool-icon-button>\n            `}\n          >\n            <stroke-style-panel\n              slot\n              .strokeWidth=${selectedLineSize}\n              .strokeStyle=${selectedLineStyle}\n              .strokeColor=${selectedColor}\n              .setStrokeStyle=${(e: LineStyleEvent) =>\n                this._setConnectorStorke(e)}\n              .setStrokeColor=${(e: ColorEvent) =>\n                this._setConnectorColor(e.detail)}\n            >\n            </stroke-style-panel>\n          </edgeless-menu-button>\n        `,\n\n        html`\n          <edgeless-menu-button\n            .button=${html`\n              <edgeless-tool-icon-button aria-label=\"Style\" .tooltip=${'Style'}>\n                ${choose(selectedRough, STYLE_CHOOSE)}${SmallArrowDownIcon}\n              </edgeless-tool-icon-button>\n            `}\n          >\n            <div slot data-orientation=\"horizontal\">\n              ${repeat(\n                STYLE_LIST,\n                item => item.name,\n                ({ name, value, icon }) => html`\n                  <edgeless-tool-icon-button\n                    aria-label=${name}\n                    .tooltip=${name}\n                    .active=${selectedRough === value}\n                    .activeMode=${'background'}\n                    @click=${() => this._setConnectorRough(value)}\n                  >\n                    ${icon}\n                  </edgeless-tool-icon-button>\n                `\n              )}\n            </div>\n          </edgeless-menu-button>\n        `,\n\n        html`\n          <edgeless-menu-button\n            .button=${html`\n              <edgeless-tool-icon-button\n                aria-label=\"Start point style\"\n                .tooltip=${'Start point style'}\n              >\n                ${this._getEndpointIcon(\n                  FRONT_ENDPOINT_STYLE_LIST,\n                  selectedStartPointStyle\n                )}${SmallArrowDownIcon}\n              </edgeless-tool-icon-button>\n            `}\n          >\n            <div slot data-orientation=\"horizontal\">\n              ${repeat(\n                FRONT_ENDPOINT_STYLE_LIST,\n                item => item.value,\n                ({ value, icon }) => html`\n                  <edgeless-tool-icon-button\n                    aria-label=${value}\n                    .tooltip=${value}\n                    .active=${selectedStartPointStyle === value}\n                    .activeMode=${'background'}\n                    @click=${() =>\n                      this._setConnectorPointStyle(\n                        ConnectorEndpoint.Front,\n                        value\n                      )}\n                  >\n                    ${icon}\n                  </edgeless-tool-icon-button>\n                `\n              )}\n            </div>\n          </edgeless-menu-button>\n\n          <edgeless-tool-icon-button\n            aria-label=\"Flip direction\"\n            .tooltip=${'Flip direction'}\n            .disabled=${false}\n            @click=${() =>\n              this._flipEndpointStyle(\n                selectedStartPointStyle,\n                selectedEndPointStyle\n              )}\n          >\n            ${FlipDirectionIcon}\n          </edgeless-tool-icon-button>\n\n          <edgeless-menu-button\n            .button=${html`\n              <edgeless-tool-icon-button\n                aria-label=\"End point style\"\n                .tooltip=${'End point style'}\n              >\n                ${this._getEndpointIcon(\n                  REAR_ENDPOINT_STYLE_LIST,\n                  selectedEndPointStyle\n                )}${SmallArrowDownIcon}\n              </edgeless-tool-icon-button>\n            `}\n          >\n            <div slot data-orientation=\"horizontal\">\n              ${repeat(\n                REAR_ENDPOINT_STYLE_LIST,\n                item => item.value,\n                ({ value, icon }) => html`\n                  <edgeless-tool-icon-button\n                    aria-label=${value}\n                    .tooltip=${value}\n                    .active=${selectedEndPointStyle === value}\n                    .activeMode=${'background'}\n                    @click=${() =>\n                      this._setConnectorPointStyle(\n                        ConnectorEndpoint.Rear,\n                        value\n                      )}\n                  >\n                    ${icon}\n                  </edgeless-tool-icon-button>\n                `\n              )}\n            </div>\n          </edgeless-menu-button>\n\n          <edgeless-menu-button\n            .button=${html`\n              <edgeless-tool-icon-button\n                aria-label=\"Shape\"\n                .tooltip=${'Connector shape'}\n              >\n                ${choose(selectedMode, MODE_CHOOSE)}${SmallArrowDownIcon}\n              </edgeless-tool-icon-button>\n            `}\n          >\n            <div slot data-orientation=\"horizontal\">\n              ${repeat(\n                MODE_LIST,\n                item => item.name,\n                ({ name, value, icon }) => html`\n                  <edgeless-tool-icon-button\n                    aria-label=${name}\n                    .tooltip=${name}\n                    .active=${selectedMode === value}\n                    .activeMode=${'background'}\n                    @click=${() => this._setConnectorMode(value)}\n                  >\n                    ${icon}\n                  </edgeless-tool-icon-button>\n                `\n              )}\n            </div>\n          </edgeless-menu-button>\n        `,\n\n        choose<string, TemplateResult<1> | typeof nothing>(\n          this._showAddButtonOrTextMenu(),\n          [\n            [\n              'button',\n              () => html`\n                <edgeless-tool-icon-button\n                  aria-label=\"Add text\"\n                  .tooltip=${'Add text'}\n                  @click=${this._addLabel}\n                >\n                  ${AddTextIcon}\n                </edgeless-tool-icon-button>\n              `,\n            ],\n            [\n              'menu',\n              () => html`\n                <edgeless-change-text-menu\n                  .elementType=${'connector'}\n                  .elements=${this.elements}\n                  .edgeless=${this.edgeless}\n                ></edgeless-change-text-menu>\n              `,\n            ],\n            ['nothing', () => nothing],\n          ]\n        ),\n      ].filter(button => button !== nothing),\n      renderMenuDivider\n    );\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'edgeless-change-connector-button': EdgelessChangeConnectorButton;\n  }\n}\n\nexport function renderConnectorButton(\n  edgeless: EdgelessRootBlockComponent,\n  elements?: ConnectorElementModel[]\n) {\n  if (!elements?.length) return nothing;\n\n  return html`\n    <edgeless-change-connector-button\n      .elements=${elements}\n      .edgeless=${edgeless}\n    >\n    </edgeless-change-connector-button>\n  `;\n}\n"]}