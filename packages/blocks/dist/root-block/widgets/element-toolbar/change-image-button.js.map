{"version":3,"file":"change-image-button.js","sourceRoot":"","sources":["../../../../src/root-block/widgets/element-toolbar/change-image-button.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,OAAO,uDAAuD,CAAC;AAE/D,OAAO,EAAE,cAAc,EAAE,MAAM,uBAAuB,CAAC;AACvD,OAAO,EAAE,YAAY,EAAE,MAAM,0BAA0B,CAAC;AACxD,OAAO,EAAE,IAAI,EAAE,UAAU,EAAE,OAAO,EAAE,MAAM,KAAK,CAAC;AAChD,OAAO,EAAE,aAAa,EAAE,QAAQ,EAAE,MAAM,mBAAmB,CAAC;AAE5D,OAAO,EAAE,WAAW,EAAE,MAAM,gCAAgC,CAAC;IAMhD,yBAAyB;4BADrC,aAAa,CAAC,8BAA8B,CAAC;;;;sBACC,cAAc,CAAC,UAAU,CAAC;;;;;;;yCAAlC,SAAQ,WAA0B;;;;iCACtE,QAAQ,CAAC,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC;oCAG9B,QAAQ,CAAC,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC;YAF/B,oKAAS,KAAK,6BAAL,KAAK,qFAAmB;YAGjC,6KAAS,QAAQ,6BAAR,QAAQ,2FAA8B;YALjD,6KA6CC;;;YA7CY,uDAAyB;;QAEpC,+EAAiC;QAAjC,IAAS,KAAK,2CAAmB;QAAjC,IAAS,KAAK,iDAAmB;QAGjC,0IAA+C;QAA/C,IAAS,QAAQ,8CAA8B;QAA/C,IAAS,QAAQ,oDAA8B;QAE/C,IAAY,IAAI;YACd,OAAO,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC;QACxB,CAAC;QAED,IAAY,aAAa;YACvB,MAAM,cAAc,GAClB,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,SAAS,CAAC,iBAAiB,CAAC,MAAM,CAAC,GAAG,CAAC,EAAE,CAC7D,GAAG,CAAC,QAAQ,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,CACrC,CAAC;YACJ,IAAI,cAAc,CAAC,MAAM,KAAK,CAAC,EAAE,CAAC;gBAChC,OAAO;YACT,CAAC;YAED,MAAM,YAAY,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,IAAI,CAAC,QAAQ,CAClD,cAAc,CAAC,CAAC,CAAC,CAAC,OAAO,CACI,CAAC;YAChC,YAAY,CAAC,YAAY,CAAC,CAAC;YAE3B,OAAO,YAAY,CAAC;QACtB,CAAC;QAEO,YAAY;YAClB,IAAI,CAAC,aAAa,EAAE,aAAa,CAAC,IAAI,EAAE,CAAC;QAC3C,CAAC;QAEQ,MAAM;YACb,OAAO,IAAI,CAAA;;;mBAGI,aAAa;;oBAEZ,IAAI,CAAC,IAAI,CAAC,QAAQ;iBACrB,GAAG,EAAE,CAAC,IAAI,CAAC,YAAY,EAAE;;UAEhC,WAAW;;KAEhB,CAAC;QACJ,CAAC;;;;;;;;SA5CU,yBAAyB;AAqDtC,MAAM,UAAU,uBAAuB,CACrC,QAAoC,EACpC,MAA0B;IAE1B,IAAI,MAAM,EAAE,MAAM,KAAK,CAAC;QAAE,OAAO,OAAO,CAAC;IAEzC,OAAO,IAAI,CAAA;;eAEE,MAAM,CAAC,CAAC,CAAC;kBACN,QAAQ;;GAEvB,CAAC;AACJ,CAAC","sourcesContent":["import '../../edgeless/components/buttons/tool-icon-button.js';\n\nimport { WithDisposable } from '@blocksuite/block-std';\nimport { assertExists } from '@blocksuite/global/utils';\nimport { html, LitElement, nothing } from 'lit';\nimport { customElement, property } from 'lit/decorators.js';\n\nimport { CaptionIcon } from '../../../_common/icons/text.js';\nimport type { ImageBlockComponent } from '../../../image-block/image-block.js';\nimport type { ImageBlockModel } from '../../../image-block/image-model.js';\nimport type { EdgelessRootBlockComponent } from '../../edgeless/edgeless-root-block.js';\n\n@customElement('edgeless-change-image-button')\nexport class EdgelessChangeImageButton extends WithDisposable(LitElement) {\n  @property({ attribute: false })\n  accessor model!: ImageBlockModel;\n\n  @property({ attribute: false })\n  accessor edgeless!: EdgelessRootBlockComponent;\n\n  private get _doc() {\n    return this.model.doc;\n  }\n\n  private get _blockElement() {\n    const blockSelection =\n      this.edgeless.service.selection.surfaceSelections.filter(sel =>\n        sel.elements.includes(this.model.id)\n      );\n    if (blockSelection.length !== 1) {\n      return;\n    }\n\n    const blockElement = this.edgeless.std.view.getBlock(\n      blockSelection[0].blockId\n    ) as ImageBlockComponent | null;\n    assertExists(blockElement);\n\n    return blockElement;\n  }\n\n  private _showCaption() {\n    this._blockElement?.captionEditor.show();\n  }\n\n  override render() {\n    return html`\n      <edgeless-tool-icon-button\n        aria-label=\"Add caption\"\n        .tooltip=${'Add caption'}\n        class=\"change-image-button caption\"\n        ?disabled=${this._doc.readonly}\n        @click=${() => this._showCaption()}\n      >\n        ${CaptionIcon}\n      </edgeless-tool-icon-button>\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'edgeless-change-image-button': EdgelessChangeImageButton;\n  }\n}\n\nexport function renderChangeImageButton(\n  edgeless: EdgelessRootBlockComponent,\n  images?: ImageBlockModel[]\n) {\n  if (images?.length !== 1) return nothing;\n\n  return html`\n    <edgeless-change-image-button\n      .model=${images[0]}\n      .edgeless=${edgeless}\n    ></edgeless-change-image-button>\n  `;\n}\n"]}