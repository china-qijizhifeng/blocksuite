{"version":3,"file":"crud.js","sourceRoot":"","sources":["../../../../src/root-block/edgeless/utils/crud.ts"],"names":[],"mappings":"AAEA,OAAO,EAAE,aAAa,EAAE,WAAW,EAAE,MAAM,YAAY,CAAC;AAExD,MAAM,UAAU,cAAc,CAC5B,OAA8B,EAC9B,QAAwC;IAExC,MAAM,GAAG,GAAG,IAAI,GAAG,CAAC,QAAQ,CAAC,CAAC;IAC9B,MAAM,OAAO,GAAG,OAAO,CAAC,QAAQ,CAAC,OAAO,CAAC;IAEzC,QAAQ,CAAC,OAAO,CAAC,OAAO,CAAC,EAAE;QACzB,IAAI,aAAa,CAAC,OAAO,CAAC,EAAE,CAAC;YAC3B,MAAM,UAAU,GAAG,OAAO,CAAC,aAAa,CAAC,OAAsB,CAAC,CAAC;YACjE,UAAU,CAAC,OAAO,CAAC,SAAS,CAAC,EAAE,CAAC,GAAG,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC,CAAC;QACtD,CAAC;IACH,CAAC,CAAC,CAAC;IAEH,GAAG,CAAC,OAAO,CAAC,OAAO,CAAC,EAAE;QACpB,IAAI,WAAW,CAAC,OAAO,CAAC,EAAE,CAAC;YACzB,MAAM,QAAQ,GAAG,OAAO,CAAC,GAAG,CAAC,IAAI,EAAE,QAAQ,IAAI,EAAE,CAAC;YAClD,4CAA4C;YAC5C,IAAI,QAAQ,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC;gBACxB,OAAO,CAAC,GAAG,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC;YACnC,CAAC;QACH,CAAC;aAAM,CAAC;YACN,OAAO,CAAC,aAAa,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;QACpC,CAAC;IACH,CAAC,CAAC,CAAC;AACL,CAAC","sourcesContent":["import type { Connectable } from '../../../_common/utils/index.js';\nimport type { SurfaceBlockComponent } from '../../../surface-block/surface-block.js';\nimport { isConnectable, isNoteBlock } from './query.js';\n\nexport function deleteElements(\n  surface: SurfaceBlockComponent,\n  elements: BlockSuite.EdgelessModelType[]\n) {\n  const set = new Set(elements);\n  const service = surface.edgeless.service;\n\n  elements.forEach(element => {\n    if (isConnectable(element)) {\n      const connectors = service.getConnectors(element as Connectable);\n      connectors.forEach(connector => set.add(connector));\n    }\n  });\n\n  set.forEach(element => {\n    if (isNoteBlock(element)) {\n      const children = surface.doc.root?.children ?? [];\n      // FIXME: should always keep at least 1 note\n      if (children.length > 1) {\n        surface.doc.deleteBlock(element);\n      }\n    } else {\n      service.removeElement(element.id);\n    }\n  });\n}\n"]}