{"version":3,"file":"size-panel.js","sourceRoot":"","sources":["../../../../../src/root-block/edgeless/components/panel/size-panel.ts"],"names":[],"mappings":"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","sourcesContent":["import '../buttons/tool-icon-button.js';\n\nimport { css, html, LitElement, nothing } from 'lit';\nimport { customElement, property } from 'lit/decorators.js';\nimport { repeat } from 'lit/directives/repeat.js';\n\nimport { CheckIcon } from '../../../../_common/icons/edgeless.js';\nimport { stopPropagation } from '../../../../_common/utils/event.js';\nimport { clamp } from '../../../../_common/utils/math.js';\n\nconst MIN_SIZE = 1;\nconst MAX_SIZE = 200;\n\ntype SizeItem = {\n  name?: string;\n  value: number;\n};\n\n@customElement('edgeless-size-panel')\nexport class EdgelessSizePanel extends LitElement {\n  static override styles = css`\n    :host {\n      display: flex;\n      flex-direction: column;\n      align-items: flex-start;\n      gap: 4px;\n      width: 68px;\n    }\n\n    edgeless-tool-icon-button {\n      align-self: stretch;\n    }\n\n    .size-input {\n      display: flex;\n      align-self: stretch;\n      width: 100%;\n      border: 0.5px solid var(--affine-border-color);\n      border-radius: 8px;\n      padding: 4px 8px;\n      box-sizing: border-box;\n    }\n\n    .size-input::placeholder {\n      color: var(--affine-placeholder-color);\n    }\n\n    .size-input:focus {\n      outline-color: var(--affine-primary-color);\n      outline-width: 0.5px;\n    }\n\n    :host([data-type='check']) {\n      gap: 0;\n    }\n\n    :host([data-type='check']) .size-input {\n      margin-top: 4px;\n    }\n  `;\n\n  @property({ attribute: false })\n  accessor size!: number;\n\n  @property({ attribute: false })\n  accessor sizeList!: SizeItem[];\n\n  @property({ attribute: false })\n  accessor onSelect: ((size: number) => void) | undefined = undefined;\n\n  @property({ attribute: false })\n  accessor onPopperCose: (() => void) | undefined = undefined;\n\n  @property({ attribute: false })\n  accessor minSize: number = MIN_SIZE;\n\n  @property({ attribute: false })\n  accessor maxSize: number = MAX_SIZE;\n\n  @property({ attribute: 'data-type' })\n  accessor type: 'normal' | 'check' = 'normal';\n\n  private _onSelect(size: number) {\n    this.onSelect?.(size);\n  }\n\n  private _onPopperClose() {\n    this.onPopperCose?.();\n  }\n\n  private _onKeydown = (e: KeyboardEvent) => {\n    e.stopPropagation();\n\n    if (e.key === 'Enter' && !e.isComposing) {\n      e.preventDefault();\n      const input = e.target as HTMLInputElement;\n      const size = parseInt(input.value.trim());\n      // Handle edge case where user enters a non-number\n      if (isNaN(size)) {\n        input.value = '';\n        return;\n      }\n\n      // Handle edge case when user enters a number that is out of range\n      this._onSelect(clamp(size, this.minSize, this.maxSize));\n      input.value = '';\n      this._onPopperClose();\n    }\n  };\n\n  renderItem() {\n    return this.type === 'normal'\n      ? this.renderItemWithNormal\n      : this.renderItemWithCheck;\n  }\n\n  renderItemWithNormal = ({ name, value }: SizeItem) => {\n    return html`\n      <edgeless-tool-icon-button\n        .iconContainerPadding=${[4, 8]}\n        .active=${this.size === value}\n        .activeMode=${'background'}\n        @click=${() => this._onSelect(value)}\n      >\n        ${name ?? value}\n      </edgeless-tool-icon-button>\n    `;\n  };\n\n  renderItemWithCheck = ({ name, value }: SizeItem) => {\n    const active = this.size === value;\n    return html`\n      <edgeless-tool-icon-button\n        .iconContainerPadding=${[4, 8]}\n        .justify=${'space-between'}\n        .active=${active}\n        @click=${() => this._onSelect(value)}\n      >\n        ${name ?? value} ${active ? CheckIcon : nothing}\n      </edgeless-tool-icon-button>\n    `;\n  };\n\n  override render() {\n    return html`\n      ${repeat(this.sizeList, sizeItem => sizeItem.name, this.renderItem())}\n\n      <input\n        class=\"size-input\"\n        type=\"text\"\n        inputmode=\"numeric\"\n        pattern=\"[0-9]*\"\n        min=\"0\"\n        placeholder=${Math.trunc(this.size)}\n        @keydown=${this._onKeydown}\n        @input=${stopPropagation}\n        @click=${stopPropagation}\n        @pointerdown=${stopPropagation}\n      />\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'edgeless-size-panel': EdgelessSizePanel;\n  }\n}\n"]}