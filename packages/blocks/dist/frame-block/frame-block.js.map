{"version":3,"file":"frame-block.js","sourceRoot":"","sources":["../../src/frame-block/frame-block.ts"],"names":[],"mappings":"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","sourcesContent":["/// <reference types=\"vite/client\" />\nimport { BlockElement } from '@blocksuite/block-std';\nimport { html } from 'lit';\nimport { customElement, state } from 'lit/decorators.js';\nimport { styleMap } from 'lit/directives/style-map.js';\n\nimport { isCssVariable } from '../_common/theme/css-variables.js';\nimport type { EdgelessFrameTitle } from '../root-block/edgeless/components/block-portal/frame/edgeless-frame.js';\nimport { Bound } from '../surface-block/index.js';\nimport type { FrameBlockModel } from './frame-model.js';\n\n@customElement('affine-frame')\nexport class FrameBlockComponent extends BlockElement<FrameBlockModel> {\n  @state()\n  private accessor _isNavigator = false;\n\n  get titleElement(): EdgelessFrameTitle | null {\n    return (\n      this.closest('affine-edgeless-root')?.querySelector?.(\n        `[data-frame-title-id=\"${this.model.id}\"]`\n      ) ?? null\n    );\n  }\n\n  private get _surface() {\n    return this.closest('affine-edgeless-root')!.surface;\n  }\n\n  private get _edgeless() {\n    return this.closest('affine-edgeless-root');\n  }\n\n  override connectedCallback() {\n    super.connectedCallback();\n\n    let lastZoom = 0;\n    this._disposables.add(\n      this._edgeless!.service.viewport.viewportUpdated.on(({ zoom }) => {\n        if (zoom !== lastZoom) {\n          lastZoom = zoom;\n          this.requestUpdate();\n        }\n      })\n    );\n\n    this._disposables.add(\n      this.doc.slots.blockUpdated.on(({ type, id }) => {\n        if (id === this.model.id && type === 'update') {\n          this.requestUpdate();\n        }\n      })\n    );\n  }\n\n  override createRenderRoot() {\n    return this;\n  }\n\n  override firstUpdated() {\n    this._surface.edgeless.slots.edgelessToolUpdated.on(tool => {\n      this._isNavigator = tool.type === 'frameNavigator';\n    });\n  }\n\n  override renderBlock() {\n    const { model, _isNavigator } = this;\n    const bound = Bound.deserialize(model.xywh);\n\n    return html`\n      <div\n        class=\"affine-frame-container\"\n        style=${styleMap({\n          width: bound.w + 'px',\n          height: bound.h + 'px',\n          backgroundColor: isCssVariable(model.background)\n            ? `var(${model.background})`\n            : '',\n          borderRadius: '8px',\n          border: _isNavigator ? 'none' : `2px solid var(--affine-black-30)`,\n        })}\n      ></div>\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'affine-frame': FrameBlockComponent;\n  }\n}\n"]}