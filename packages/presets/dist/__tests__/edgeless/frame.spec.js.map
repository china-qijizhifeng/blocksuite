{"version":3,"file":"frame.spec.js","sourceRoot":"","sources":["../../../src/__tests__/edgeless/frame.spec.ts"],"names":[],"mappings":"AACA,OAAO,EAAE,IAAI,EAAE,MAAM,mBAAmB,CAAC;AACzC,OAAO,EAAE,UAAU,EAAE,QAAQ,EAAE,MAAM,EAAE,IAAI,EAAE,MAAM,QAAQ,CAAC;AAE5D,OAAO,EAAE,IAAI,EAAE,MAAM,oBAAoB,CAAC;AAC1C,OAAO,EAAE,eAAe,EAAE,MAAM,sBAAsB,CAAC;AACvD,OAAO,EAAE,WAAW,EAAE,MAAM,mBAAmB,CAAC;AAEhD,QAAQ,CAAC,OAAO,EAAE,GAAG,EAAE;IACrB,IAAI,OAA+C,CAAC;IAEpD,UAAU,CAAC,KAAK,IAAI,EAAE;QACpB,MAAM,OAAO,GAAG,MAAM,WAAW,CAAC,UAAU,CAAC,CAAC;QAC9C,OAAO,GAAG,eAAe,CAAC,MAAM,CAAC,GAAG,EAAE,MAAM,CAAC,MAAM,EAAE,UAAU,CAAC,CAAC,OAAO,CAAC;QAEzE,OAAO,OAAO,CAAC;IACjB,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,yBAAyB,EAAE,KAAK,IAAI,EAAE;QACzC,MAAM,KAAK,GAAG,OAAO,CAAC,GAAG,CAAC,QAAQ,CAChC,cAAc,EACd;YACE,IAAI,EAAE,eAAe;YACrB,KAAK,EAAE,IAAI,IAAI,CAAC,SAAS,CAAC;SAC3B,EACD,OAAO,CAAC,OAAO,CAAC,EAAE,CACnB,CAAC;QACF,MAAM,IAAI,EAAE,CAAC;QAEb,MAAM,QAAQ,GAAG,QAAQ,CAAC,aAAa,CACrC,6CAA6C,KAAK,0BAA0B,CAC7E,CAAC;QACF,MAAM,IAAI,GAAG,QAAQ,EAAE,qBAAqB,EAAE,CAAC;QAE/C,MAAM,CAAC,QAAQ,CAAC,CAAC,GAAG,CAAC,QAAQ,EAAE,CAAC;QAChC,MAAM,CAAC,IAAI,CAAC,CAAC,GAAG,CAAC,QAAQ,EAAE,CAAC;QAC5B,MAAM,CAAC,IAAK,CAAC,KAAK,CAAC,CAAC,eAAe,CAAC,CAAC,CAAC,CAAC;QACvC,MAAM,CAAC,IAAK,CAAC,MAAM,CAAC,CAAC,eAAe,CAAC,CAAC,CAAC,CAAC;QAExC,MAAM,CAAC,MAAM,EAAE,MAAM,CAAC,GAAG,OAAO,CAAC,QAAQ,CAAC,YAAY,CAAC,IAAK,CAAC,CAAC,EAAE,IAAK,CAAC,CAAC,CAAC,CAAC;QACzE,MAAM,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;QACvB,MAAM,CAAC,MAAM,CAAC,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC;QAE/B,MAAM,WAAW,GAAG,OAAO,CAAC,GAAG,CAAC,QAAQ,CACtC,cAAc,EACd;YACE,IAAI,EAAE,iBAAiB;YACvB,KAAK,EAAE,IAAI,IAAI,CAAC,SAAS,CAAC;SAC3B,EACD,OAAO,CAAC,OAAO,CAAC,EAAE,CACnB,CAAC;QACF,MAAM,IAAI,EAAE,CAAC;QACb,MAAM,WAAW,GAAG,QAAQ,CAAC,aAAa,CACxC,6CAA6C,WAAW,wBAAwB,CACjF,CAAC;QACF,MAAM,eAAe,GAAG,WAAY,CAAC,qBAAqB,EAAG,CAAC;QAC9D,MAAM,CAAC,YAAY,EAAE,YAAY,CAAC,GAAG,OAAO,CAAC,QAAQ,CAAC,YAAY,CAChE,eAAe,CAAC,CAAC,EACjB,eAAe,CAAC,CAAC,CAClB,CAAC;QAEF,MAAM,CAAC,YAAY,CAAC,CAAC,eAAe,CAAC,EAAE,CAAC,CAAC;QACzC,MAAM,CAAC,YAAY,CAAC,CAAC,eAAe,CAAC,EAAE,CAAC,CAAC;IAC3C,CAAC,CAAC,CAAC;AACL,CAAC,CAAC,CAAC","sourcesContent":["import type { EdgelessRootBlockComponent } from '@blocksuite/blocks';\nimport { Text } from '@blocksuite/store';\nimport { beforeEach, describe, expect, test } from 'vitest';\n\nimport { wait } from '../utils/common.js';\nimport { getDocRootBlock } from '../utils/edgeless.js';\nimport { setupEditor } from '../utils/setup.js';\n\ndescribe('frame', () => {\n  let service!: EdgelessRootBlockComponent['service'];\n\n  beforeEach(async () => {\n    const cleanup = await setupEditor('edgeless');\n    service = getDocRootBlock(window.doc, window.editor, 'edgeless').service;\n\n    return cleanup;\n  });\n\n  test('frame should have title', async () => {\n    const frame = service.doc.addBlock(\n      'affine:frame',\n      {\n        xywh: '[0,0,300,300]',\n        title: new Text('Frame 1'),\n      },\n      service.surface.id\n    );\n    await wait();\n\n    const titleDom = document.querySelector(\n      `edgeless-frame-title[data-frame-title-id=\"${frame}\"] > .affine-frame-title`\n    );\n    const rect = titleDom?.getBoundingClientRect();\n\n    expect(titleDom).not.toBeNull();\n    expect(rect).not.toBeNull();\n    expect(rect!.width).toBeGreaterThan(0);\n    expect(rect!.height).toBeGreaterThan(0);\n\n    const [titleX, titleY] = service.viewport.toModelCoord(rect!.x, rect!.y);\n    expect(titleX).toBe(0);\n    expect(titleY).toBeLessThan(0);\n\n    const nestedFrame = service.doc.addBlock(\n      'affine:frame',\n      {\n        xywh: '[20,20,200,200]',\n        title: new Text('Frame 2'),\n      },\n      service.surface.id\n    );\n    await wait();\n    const nestedTitle = document.querySelector(\n      `edgeless-frame-title[data-frame-title-id=\"${nestedFrame}\"] .affine-frame-title`\n    );\n    const nestedTitleRect = nestedTitle!.getBoundingClientRect()!;\n    const [nestedTitleX, nestedTitleY] = service.viewport.toModelCoord(\n      nestedTitleRect.x,\n      nestedTitleRect.y\n    );\n\n    expect(nestedTitleX).toBeGreaterThan(20);\n    expect(nestedTitleY).toBeGreaterThan(20);\n  });\n});\n"]}