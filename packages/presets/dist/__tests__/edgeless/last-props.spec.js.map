{"version":3,"file":"last-props.spec.js","sourceRoot":"","sources":["../../../src/__tests__/edgeless/last-props.spec.ts"],"names":[],"mappings":"AAOA,OAAO,EAAE,UAAU,EAAE,QAAQ,EAAE,MAAM,EAAE,IAAI,EAAE,MAAM,QAAQ,CAAC;AAE5D,OAAO,EAAE,eAAe,EAAE,MAAM,sBAAsB,CAAC;AACvD,OAAO,EAAE,WAAW,EAAE,MAAM,mBAAmB,CAAC;AAEhD,QAAQ,CAAC,kBAAkB,EAAE,GAAG,EAAE;IAChC,IAAI,YAAyC,CAAC;IAC9C,IAAI,OAA+C,CAAC;IAEpD,UAAU,CAAC,KAAK,IAAI,EAAE;QACpB,cAAc,CAAC,UAAU,CAAC,wBAAwB,CAAC,CAAC;QACpD,MAAM,OAAO,GAAG,MAAM,WAAW,CAAC,UAAU,CAAC,CAAC;QAC9C,YAAY,GAAG,eAAe,CAAC,MAAM,CAAC,GAAG,EAAE,MAAM,CAAC,MAAM,EAAE,UAAU,CAAC,CAAC;QACtE,OAAO,GAAG,YAAY,CAAC,OAAO,CAAC;QAC/B,OAAO,OAAO,CAAC;IACjB,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,OAAO,EAAE,GAAG,EAAE;QACjB,MAAM,EAAE,GAAG,OAAO,CAAC,UAAU,CAAC,OAAO,EAAE,EAAE,SAAS,EAAE,MAAM,EAAE,CAAC,CAAC;QAC9D,MAAM,KAAK,GAAG,OAAO,CAAC,cAAc,CAAC,EAAE,CAAsB,CAAC;QAC9D,MAAM,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC,IAAI,CAAC,+BAA+B,CAAC,CAAC;QAC9D,MAAM,CAAC,KAAK,CAAC,WAAW,CAAC,CAAC,IAAI,CAAC,8BAA8B,CAAC,CAAC;QAC/D,MAAM,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;QACzC,OAAO,CAAC,aAAa,CAAC,EAAE,EAAE,EAAE,SAAS,EAAE,+BAA+B,EAAE,CAAC,CAAC;QAC1E,MAAM,WAAW,GAAG,OAAO,CAAC,cAAc,CACxC,OAAO,CAAC,UAAU,CAAC,OAAO,EAAE,EAAE,SAAS,EAAE,MAAM,EAAE,CAAC,CAC9B,CAAC;QACvB,MAAM,CAAC,WAAW,CAAC,SAAS,CAAC,CAAC,IAAI,CAAC,+BAA+B,CAAC,CAAC;IACtE,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,WAAW,EAAE,GAAG,EAAE;QACrB,MAAM,EAAE,GAAG,OAAO,CAAC,UAAU,CAAC,WAAW,EAAE,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC;QACxD,MAAM,SAAS,GAAG,OAAO,CAAC,cAAc,CAAC,EAAE,CAA0B,CAAC;QACtE,MAAM,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,4BAA4B,CAAC,CAAC;QAC5D,MAAM,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;QACtC,MAAM,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;QAC5C,MAAM,CAAC,SAAS,CAAC,kBAAkB,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;QAClD,MAAM,CAAC,SAAS,CAAC,iBAAiB,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;QAClD,OAAO,CAAC,aAAa,CAAC,EAAE,EAAE,EAAE,WAAW,EAAE,EAAE,EAAE,CAAC,CAAC;QAC/C,MAAM,eAAe,GAAG,OAAO,CAAC,cAAc,CAC5C,OAAO,CAAC,UAAU,CAAC,WAAW,EAAE,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CACxB,CAAC;QACvB,MAAM,CAAC,eAAe,CAAC,WAAW,CAAC,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;IAC/C,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,OAAO,EAAE,GAAG,EAAE;QACjB,MAAM,EAAE,GAAG,OAAO,CAAC,UAAU,CAAC,OAAO,EAAE,EAAE,CAAC,CAAC;QAC3C,MAAM,KAAK,GAAG,OAAO,CAAC,cAAc,CAAC,EAAE,CAAsB,CAAC;QAC9D,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,6BAA6B,CAAC,CAAC;QACxD,MAAM,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;QAChC,OAAO,CAAC,aAAa,CAAC,EAAE,EAAE,EAAE,SAAS,EAAE,EAAE,EAAE,CAAC,CAAC;QAC7C,MAAM,WAAW,GAAG,OAAO,CAAC,cAAc,CACxC,OAAO,CAAC,UAAU,CAAC,OAAO,EAAE,EAAE,CAAC,CACX,CAAC;QACvB,MAAM,CAAC,WAAW,CAAC,SAAS,CAAC,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;IACzC,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,MAAM,EAAE,GAAG,EAAE;QAChB,MAAM,EAAE,GAAG,OAAO,CAAC,UAAU,CAAC,MAAM,EAAE,EAAE,CAAC,CAAC;QAC1C,MAAM,IAAI,GAAG,OAAO,CAAC,cAAc,CAAC,EAAE,CAAqB,CAAC;QAC5D,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;QAC/B,OAAO,CAAC,aAAa,CAAC,EAAE,EAAE,EAAE,QAAQ,EAAE,EAAE,EAAE,CAAC,CAAC;QAC5C,MAAM,UAAU,GAAG,OAAO,CAAC,cAAc,CACvC,OAAO,CAAC,UAAU,CAAC,MAAM,EAAE,EAAE,CAAC,CACX,CAAC;QACtB,MAAM,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;IACvC,CAAC,CAAC,CAAC;AACL,CAAC,CAAC,CAAC","sourcesContent":["import type {\n  BrushElementModel,\n  ConnectorElementModel,\n  EdgelessRootBlockComponent,\n  ShapeElementModel,\n  TextElementModel,\n} from '@blocksuite/blocks';\nimport { beforeEach, describe, expect, test } from 'vitest';\n\nimport { getDocRootBlock } from '../utils/edgeless.js';\nimport { setupEditor } from '../utils/setup.js';\n\ndescribe('apply last props', () => {\n  let edgelessRoot!: EdgelessRootBlockComponent;\n  let service!: EdgelessRootBlockComponent['service'];\n\n  beforeEach(async () => {\n    sessionStorage.removeItem('blocksuite:prop:record');\n    const cleanup = await setupEditor('edgeless');\n    edgelessRoot = getDocRootBlock(window.doc, window.editor, 'edgeless');\n    service = edgelessRoot.service;\n    return cleanup;\n  });\n\n  test('shape', () => {\n    const id = service.addElement('shape', { shapeType: 'rect' });\n    const shape = service.getElementById(id) as ShapeElementModel;\n    expect(shape.fillColor).toBe('--affine-palette-shape-yellow');\n    expect(shape.strokeColor).toBe('--affine-palette-line-yellow');\n    expect(shape.shapeStyle).toBe('General');\n    service.updateElement(id, { fillColor: '--affine-palette-shape-orange' });\n    const secondShape = service.getElementById(\n      service.addElement('shape', { shapeType: 'rect' })\n    ) as ShapeElementModel;\n    expect(secondShape.fillColor).toBe('--affine-palette-shape-orange');\n  });\n\n  test('connector', () => {\n    const id = service.addElement('connector', { mode: 0 });\n    const connector = service.getElementById(id) as ConnectorElementModel;\n    expect(connector.stroke).toBe('--affine-palette-line-grey');\n    expect(connector.strokeWidth).toBe(2);\n    expect(connector.strokeStyle).toBe('solid');\n    expect(connector.frontEndpointStyle).toBe('None');\n    expect(connector.rearEndpointStyle).toBe('Arrow');\n    service.updateElement(id, { strokeWidth: 10 });\n    const secondConnector = service.getElementById(\n      service.addElement('connector', { mode: 1 })\n    ) as ShapeElementModel;\n    expect(secondConnector.strokeWidth).toBe(10);\n  });\n\n  test('brush', () => {\n    const id = service.addElement('brush', {});\n    const brush = service.getElementById(id) as BrushElementModel;\n    expect(brush.color).toBe('--affine-palette-line-black');\n    expect(brush.lineWidth).toBe(4);\n    service.updateElement(id, { lineWidth: 10 });\n    const secondBrush = service.getElementById(\n      service.addElement('brush', {})\n    ) as BrushElementModel;\n    expect(secondBrush.lineWidth).toBe(10);\n  });\n\n  test('text', () => {\n    const id = service.addElement('text', {});\n    const text = service.getElementById(id) as TextElementModel;\n    expect(text.fontSize).toBe(24);\n    service.updateElement(id, { fontSize: 36 });\n    const secondText = service.getElementById(\n      service.addElement('text', {})\n    ) as TextElementModel;\n    expect(secondText.fontSize).toBe(36);\n  });\n});\n"]}