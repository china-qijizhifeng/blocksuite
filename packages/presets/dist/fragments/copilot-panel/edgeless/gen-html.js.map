{"version":3,"file":"gen-html.js","sourceRoot":"","sources":["../../../../src/fragments/copilot-panel/edgeless/gen-html.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,aAAa,EAAE,MAAM,sCAAsC,CAAC;AACrE,OAAO,EAAE,qBAAqB,EAAE,MAAM,oCAAoC,CAAC;AAE3E,MAAM,CAAC,MAAM,OAAO,GAAG,KAAK,EAC1B,GAAW,EACX,eAGC,EACD,EAAE;IACF,MAAM,MAAM,GAAG,MAAM,aAAa;SAC/B,UAAU,CAAC,cAAc,EAAE,qBAAqB,CAAC;SACjD,YAAY,CAAC;QACZ;YACE,IAAI,EAAE,QAAQ;YACd,OAAO,EAAE;;;;;;;;;;;;;;;;;;;;;;;;;2EAyB0D;SACpE;QACD;YACE,IAAI,EAAE,MAAM;YACZ,OAAO,EAAE;gBACP;oBACE,IAAI,EAAE,WAAW;oBACjB,SAAS,EAAE;wBACT,MAAM,EAAE,MAAM;wBACd,GAAG,EAAE,GAAG;qBACT;iBACF;gBACD;oBACE,IAAI,EAAE,MAAM;oBACZ,IAAI,EAAE,oIAAoI;iBAC3I;gBACD,GAAG,CAAC,eAAe;oBACjB,CAAC,CAAE;wBACC;4BACE,IAAI,EAAE,MAAM;4BACZ,IAAI,EAAE,sGAAsG;yBAC7G;wBACD;4BACE,IAAI,EAAE,WAAW;4BACjB,SAAS,EAAE;gCACT,GAAG,EAAE,eAAe,CAAC,MAAM;gCAC3B,MAAM,EAAE,MAAM;6BACf;yBACF;wBACD;4BACE,IAAI,EAAE,MAAM;4BACZ,IAAI,EAAE,gDAAgD,eAAe,CAAC,IAAI,EAAE;yBAC7E;qBACQ;oBACb,CAAC,CAAC,EAAE,CAAC;aACR;SACF;KACF,CAAC,CAAC;IACL,IAAI,CAAC,MAAM,EAAE,CAAC;QACZ,OAAO;IACT,CAAC;IACD,MAAM,KAAK,GAAG,MAAM,CAAC,OAAO,CAAC,iBAAiB,CAAC,CAAC;IAChD,MAAM,GAAG,GAAG,MAAM,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC;IACtC,OAAO,MAAM,CAAC,KAAK,CAAC,KAAK,EAAE,GAAG,GAAG,SAAS,CAAC,MAAM,CAAC,CAAC;AACrD,CAAC,CAAC","sourcesContent":["import { copilotConfig } from '../copilot-service/copilot-config.js';\nimport { Image2TextServiceKind } from '../copilot-service/service-base.js';\n\nexport const genHtml = async (\n  img: string,\n  latestHtmlBlock?: {\n    design: string;\n    html: string;\n  }\n) => {\n  const result = await copilotConfig\n    .getService('make it real', Image2TextServiceKind)\n    .generateText([\n      {\n        role: 'system',\n        content: `You are an expert web developer who specializes in building working website prototypes from low-fidelity wireframes.\nYour job is to accept low-fidelity wireframes, then create a working prototype using HTML, CSS, and JavaScript, and finally send back the results.\nThe results should be a single HTML file.\nUse tailwind to style the website.\nPut any additional CSS styles in a style tag and any JavaScript in a script tag.\nUse unpkg or skypack to import any required dependencies.\nUse Google fonts to pull in any open source fonts you require.\nIf you have any images, load them from Unsplash or use solid colored rectangles.\n\nThe wireframes may include flow charts, diagrams, labels, arrows, sticky notes, and other features that should inform your work.\nIf there are screenshots or images, use them to inform the colors, fonts, and layout of your website.\nUse your best judgement to determine whether what you see should be part of the user interface, or else is just an annotation.\n\nUse what you know about applications and user experience to fill in any implicit business logic in the wireframes. Flesh it out, make it real!\n\nThe user may also provide you with the html of a previous design that they want you to iterate from.\nIn the wireframe, the previous design's html will appear as a white rectangle.\nUse their notes, together with the previous design, to inform your next result.\n\nSometimes it's hard for you to read the writing in the wireframes.\nFor this reason, all text from the wireframes will be provided to you as a list of strings, separated by newlines.\nUse the provided list of text from the wireframes as a reference if any text is hard to read.\n\nYou love your designers and want them to be happy. Incorporating their feedback and notes and producing working websites makes them happy.\n\nWhen sent new wireframes, respond ONLY with the contents of the html file.`,\n      },\n      {\n        role: 'user',\n        content: [\n          {\n            type: 'image_url',\n            image_url: {\n              detail: 'high',\n              url: img,\n            },\n          },\n          {\n            type: 'text',\n            text: 'Here are the latest wireframes. Could you make a new website based on these wireframes and notes and send back just the html file?',\n          },\n          ...(latestHtmlBlock\n            ? ([\n                {\n                  type: 'text',\n                  text: \"The designs also included one of your previous result. Here's the image that you used as its source:\",\n                },\n                {\n                  type: 'image_url',\n                  image_url: {\n                    url: latestHtmlBlock.design,\n                    detail: 'high',\n                  },\n                },\n                {\n                  type: 'text',\n                  text: `And here's the HTML you came up with for it: ${latestHtmlBlock.html}`,\n                },\n              ] as const)\n            : []),\n        ],\n      },\n    ]);\n  if (!result) {\n    return;\n  }\n  const start = result.indexOf('<!DOCTYPE html>');\n  const end = result.indexOf('</html>');\n  return result.slice(start, end + '</html>'.length);\n};\n"]}