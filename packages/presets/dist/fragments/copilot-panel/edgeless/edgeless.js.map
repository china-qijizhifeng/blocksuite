{"version":3,"file":"edgeless.js","sourceRoot":"","sources":["../../../../src/fragments/copilot-panel/edgeless/edgeless.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,OAAO,EAAE,iBAAiB,EAAE,cAAc,EAAE,MAAM,uBAAuB,CAAC;AAC1E,OAAO,EAAE,eAAe,EAAE,MAAM,oBAAoB,CAAC;AACrD,OAAO,EAAE,GAAG,EAAE,IAAI,EAAE,MAAM,KAAK,CAAC;AAChC,OAAO,EAAE,aAAa,EAAE,QAAQ,EAAE,MAAM,mBAAmB,CAAC;AAE5D,OAAO,EACL,0BAA0B,EAC1B,sBAAsB,EACtB,qBAAqB,EACrB,qBAAqB,GACtB,MAAM,oCAAoC,CAAC;AAE5C,OAAO,EACL,2BAA2B,EAC3B,eAAe,GAChB,MAAM,6BAA6B,CAAC;IAGxB,oBAAoB;4BADhC,aAAa,CAAC,wBAAwB,CAAC;;;;sBACE,cAAc,CAAC,iBAAiB,CAAC;;;;oCAAzC,SAAQ,WAAiC;;;;iCAGxE,QAAQ,CAAC,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC;YAC/B,oKAAS,KAAK,6BAAL,KAAK,qFAAW;YAJ3B,6KAsJC;;;;iBArJiB,WAAM,GAAG,GAAG,CAAA,EAAE,AAAR,CAAS;QAG/B,+EAAyB;QAAzB,IAAS,KAAK,2CAAW;QAAzB,IAAS,KAAK,iDAAW;QAEzB,IAAI,IAAI;YACN,OAAO,IAAI,CAAC,KAAK,CAAC,OAAO,EAAE,CAAC;QAC9B,CAAC;QAEkB,MAAM;YACvB,MAAM,MAAM,GAAG,2BAA2B,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,KAAK,CAAC,QAAQ,CAAC,MAAM,CACzE,CAAC,CAAC,EAAE,CAAC,CAAC,YAAY,eAAe,CACb,CAAC;YACvB,MAAM,eAAe,GAAG,CAAC,CAAQ,EAAE,EAAE;gBACnC,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,SAAS,GAAI,CAAC,CAAC,MAA4B,CAAC,KAAK,CAAC;YACxE,CAAC,CAAC;YACF,MAAM,aAAa,GAAG,GAAG,EAAE;gBACzB,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,aAAa,EAAE,CAAC;gBACpC,IAAI,CAAC,aAAa,EAAE,CAAC;YACvB,CAAC,CAAC;YACF,OAAO,IAAI,CAAA;;;;oBAIK,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,UAAU;;;;;;;;;;;;;;2BAcvB,cAAc;wBACjB,qBAAqB;;;;;;;oBAOzB,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,WAAW;;;;;;;;sBAQ7B,eAAe;;;;;;;;;;;;;2BAaV,eAAe;wBAClB,qBAAqB;;;;;;;oBAOzB,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,SAAS;;;;;;;;sBAQ3B,eAAe;;;;;;;;;;;;;2BAaV,YAAY;wBACf,sBAAsB;;;;;;;oBAO1B,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,aAAa;;;;;;;;;uBAS9B,aAAa;YACxB,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,OAAO;gBAC3B,CAAC,CAAC,qBAAqB;gBACvB,CAAC,CAAC,sBAAsB;;;;;;wBAMZ,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,SAAS;yBAC5B,eAAe;;;gBAGxB,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE;gBACf,OAAO,IAAI,CAAA,oBAAoB,CAAC,CAAC,EAAE;oBAC/B,CAAC,CAAC,KAAK,CAAC,QAAQ,EAAE;0BACZ,CAAC;YACb,CAAC,CAAC;;;;;;;;;;;;2BAYW,0BAA0B;wBAC7B,0BAA0B;;;;KAI7C,CAAC;QACJ,CAAC;;;;;;YArJU,uDAAoB;;;;;SAApB,oBAAoB","sourcesContent":["import { ShadowlessElement, WithDisposable } from '@blocksuite/block-std';\nimport { FrameBlockModel } from '@blocksuite/blocks';\nimport { css, html } from 'lit';\nimport { customElement, property } from 'lit/decorators.js';\n\nimport {\n  FastImage2ImageServiceKind,\n  Image2ImageServiceKind,\n  Image2TextServiceKind,\n  Text2ImageServiceKind,\n} from '../copilot-service/service-base.js';\nimport type { AILogic } from '../logic.js';\nimport {\n  getSurfaceElementFromEditor,\n  stopPropagation,\n} from '../utils/selection-utils.js';\n\n@customElement('copilot-edgeless-panel')\nexport class CopilotEdgelessPanel extends WithDisposable(ShadowlessElement) {\n  static override styles = css``;\n\n  @property({ attribute: false })\n  accessor logic!: AILogic;\n\n  get host() {\n    return this.logic.getHost();\n  }\n\n  protected override render(): unknown {\n    const frames = getSurfaceElementFromEditor(this.host).model.children.filter(\n      v => v instanceof FrameBlockModel\n    ) as FrameBlockModel[];\n    const changeFromFrame = (e: Event) => {\n      this.logic.edgeless.fromFrame = (e.target as HTMLSelectElement).value;\n    };\n    const toggleAutoGen = () => {\n      this.logic.edgeless.toggleAutoGen();\n      this.requestUpdate();\n    };\n    return html`\n      <div class=\"copilot-box\">\n        <div\n          class=\"copilot-panel-action-button\"\n          @click=\"${this.logic.edgeless.makeItReal}\"\n        >\n          Make It Real\n        </div>\n        <div class=\"copilot-panel-action-description\">\n          Select some shapes and text to generate html\n        </div>\n        <div style=\"display:flex;gap: 8px;flex-direction: column\">\n          <div\n            style=\"font-size: 12px;color:var(--affine-text-secondary-color);\"\n          >\n            service:\n          </div>\n          <vendor-service-select\n            .featureKey=\"${'make it real'}\"\n            .service=\"${Image2TextServiceKind}\"\n          ></vendor-service-select>\n        </div>\n      </div>\n      <div class=\"copilot-box\">\n        <div\n          class=\"copilot-panel-action-button\"\n          @click=\"${this.logic.edgeless.createImage}\"\n        >\n          Create Image\n        </div>\n        <input\n          id=\"copilot-panel-create-image-prompt\"\n          class=\"copilot-panel-action-prompt\"\n          type=\"text\"\n          @keydown=\"${stopPropagation}\"\n          placeholder=\"Prompt\"\n        />\n        <div class=\"copilot-panel-action-description\">\n          Type prompt to create an image.\n        </div>\n        <div style=\"display:flex;gap: 8px;flex-direction: column\">\n          <div\n            style=\"font-size: 12px;color:var(--affine-text-secondary-color);\"\n          >\n            service:\n          </div>\n          <vendor-service-select\n            .featureKey=\"${'text to image'}\"\n            .service=\"${Text2ImageServiceKind}\"\n          ></vendor-service-select>\n        </div>\n      </div>\n      <div class=\"copilot-box\">\n        <div\n          class=\"copilot-panel-action-button\"\n          @click=\"${this.logic.edgeless.editImage}\"\n        >\n          Edit Image\n        </div>\n        <input\n          id=\"copilot-panel-edit-image-prompt\"\n          class=\"copilot-panel-action-prompt\"\n          type=\"text\"\n          @keydown=\"${stopPropagation}\"\n          placeholder=\"Prompt\"\n        />\n        <div class=\"copilot-panel-action-description\">\n          Select some shapes and type prompt to edit them.\n        </div>\n        <div style=\"display:flex;gap: 8px;flex-direction: column\">\n          <div\n            style=\"font-size: 12px;color:var(--affine-text-secondary-color);\"\n          >\n            service:\n          </div>\n          <vendor-service-select\n            .featureKey=\"${'edit image'}\"\n            .service=\"${Image2ImageServiceKind}\"\n          ></vendor-service-select>\n        </div>\n      </div>\n      <div class=\"copilot-box\">\n        <div\n          class=\"copilot-panel-action-button\"\n          @click=\"${this.logic.edgeless.htmlBlockDemo}\"\n        >\n          HTML Block Test\n        </div>\n        <div class=\"copilot-panel-action-description\">\n          Generate a html block\n        </div>\n      </div>\n      <div class=\"copilot-box\">\n        <div @click=\"${toggleAutoGen}\" class=\"copilot-panel-action-button\">\n          ${this.logic.edgeless.autoGen\n            ? 'Stop auto gen image'\n            : 'Start auto gen image'}\n        </div>\n        <div class=\"copilot-panel-action-description\">\n          <div>\n            Based on the shapes in frame\n            <select\n              .value=\"${this.logic.edgeless.fromFrame}\"\n              @change=\"${changeFromFrame}\"\n            >\n              <option value=\"\">None</option>\n              ${frames.map(v => {\n                return html` <option .value=\"${v.id}\">\n                  ${v.title.toString()}\n                </option>`;\n              })}\n            </select>\n          </div>\n          <div>Generate images to all connected frames</div>\n        </div>\n        <div style=\"display:flex;gap: 8px;flex-direction: column\">\n          <div\n            style=\"font-size: 12px;color:var(--affine-text-secondary-color);\"\n          >\n            service:\n          </div>\n          <vendor-service-select\n            .featureKey=\"${'real time image to image'}\"\n            .service=\"${FastImage2ImageServiceKind}\"\n          ></vendor-service-select>\n        </div>\n      </div>\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'copilot-edgeless-panel': CopilotEdgelessPanel;\n  }\n}\n"]}