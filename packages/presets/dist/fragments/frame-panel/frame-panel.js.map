{"version":3,"file":"frame-panel.js","sourceRoot":"","sources":["../../../src/fragments/frame-panel/frame-panel.ts"],"names":[],"mappings":"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","sourcesContent":["import './header/frame-panel-header.js';\nimport './body/frame-panel-body.js';\n\nimport { ShadowlessElement, WithDisposable } from '@blocksuite/block-std';\nimport { FramePreview } from '@blocksuite/blocks';\nimport { DisposableGroup } from '@blocksuite/global/utils';\nimport { baseTheme } from '@toeverything/theme';\nimport { css, html, type PropertyValues, unsafeCSS } from 'lit';\nimport { property } from 'lit/decorators.js';\n\nimport type { AffineEditorContainer } from '../../index.js';\nimport { FramePanelBody } from './body/frame-panel-body.js';\nimport { FrameCard } from './card/frame-card.js';\nimport { FrameCardTitle } from './card/frame-card-title.js';\nimport { FrameCardTitleEditor } from './card/frame-card-title-editor.js';\nimport { FramePanelHeader } from './header/frame-panel-header.js';\nimport { FramesSettingMenu } from './header/frames-setting-menu.js';\n\nconst styles = css`\n  frame-panel {\n    display: block;\n    width: 100%;\n    height: 100%;\n  }\n\n  .frame-panel-container {\n    background-color: var(--affine-background-primary-color);\n    box-sizing: border-box;\n\n    display: flex;\n    flex-direction: column;\n    align-items: stretch;\n\n    height: 100%;\n    font-family: ${unsafeCSS(baseTheme.fontSansFamily)};\n    padding: 8px;\n  }\n\n  .frame-panel-body {\n    padding-top: 12px;\n    flex-grow: 1;\n    width: 100%;\n\n    overflow: auto;\n    overflow-x: hidden;\n    scrollbar-width: thin; /* For Firefox */\n    scrollbar-color: transparent transparent; /* For Firefox */\n  }\n\n  .frame-panel-body::-webkit-scrollbar {\n    width: 4px;\n  }\n\n  .frame-panel-body::-webkit-scrollbar-thumb {\n    border-radius: 2px;\n  }\n\n  .frame-panel-body:hover::-webkit-scrollbar-thumb {\n    background-color: var(--affine-black-30);\n  }\n\n  .frame-panel-body::-webkit-scrollbar-track {\n    background-color: transparent;\n  }\n\n  .frame-panel-body::-webkit-scrollbar-corner {\n    display: none;\n  }\n`;\n\nexport class FramePanel extends WithDisposable(ShadowlessElement) {\n  get doc() {\n    return this.editor.doc;\n  }\n\n  get host() {\n    return this.editor.host;\n  }\n\n  get edgeless() {\n    return this.editor.querySelector('affine-edgeless-root');\n  }\n\n  static override styles = styles;\n\n  private _editorDisposables: DisposableGroup | null = null;\n\n  @property({ attribute: false })\n  accessor editor!: AffineEditorContainer;\n\n  @property({ attribute: false })\n  accessor fitPadding: number[] = [50, 380, 50, 50];\n\n  private _clearEditorDisposables() {\n    this._editorDisposables?.dispose();\n    this._editorDisposables = null;\n  }\n\n  private _setEditorDisposables() {\n    this._clearEditorDisposables();\n    this._editorDisposables = new DisposableGroup();\n    this._editorDisposables.add(\n      this.editor.slots.editorModeSwitched.on(() => {\n        this.editor.updateComplete\n          .then(() => this.requestUpdate())\n          .catch(console.error);\n      })\n    );\n    this._editorDisposables.add(\n      this.editor.slots.docUpdated.on(() => {\n        this.editor.updateComplete\n          .then(() => {\n            this.requestUpdate();\n          })\n          .catch(console.error);\n      })\n    );\n  }\n\n  override updated(_changedProperties: PropertyValues) {\n    if (_changedProperties.has('editor')) {\n      this._setEditorDisposables();\n    }\n  }\n\n  override connectedCallback() {\n    super.connectedCallback();\n    if (!customElements.get('frame-preview')) {\n      customElements.define('frame-preview', FramePreview);\n    }\n  }\n\n  override disconnectedCallback() {\n    super.disconnectedCallback();\n    this._clearEditorDisposables();\n  }\n\n  override render() {\n    return html`<div class=\"frame-panel-container\">\n      <frame-panel-header\n        .edgeless=${this.edgeless}\n        .editorHost=${this.host}\n      ></frame-panel-header>\n      <frame-panel-body\n        class=\"frame-panel-body\"\n        .edgeless=${this.edgeless}\n        .doc=${this.doc}\n        .editorHost=${this.host}\n        .fitPadding=${this.fitPadding}\n      ></frame-panel-body>\n    </div>`;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'frame-panel': FramePanel;\n  }\n}\n\nconst componentsMap = {\n  'frame-panel': FramePanel,\n  'frame-panel-header': FramePanelHeader,\n  'frame-panel-body': FramePanelBody,\n  'frames-setting-menu': FramesSettingMenu,\n  'frame-card': FrameCard,\n  'frame-card-title': FrameCardTitle,\n  'frame-card-title-editor': FrameCardTitleEditor,\n};\n\nexport function registerFramePanelComponents(\n  callback: (components: typeof componentsMap) => void\n) {\n  callback(componentsMap);\n}\n"]}