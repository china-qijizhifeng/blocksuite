{"version":3,"file":"template.js","sourceRoot":"","sources":["../../../src/ai/slides/template.ts"],"names":[],"mappings":"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","sourcesContent":["import { Bound } from '@blocksuite/blocks';\nimport { nanoid } from '@blocksuite/store';\n\nimport { AIProvider } from '../provider.js';\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nconst replaceText = (text: Record<string, string>, template: any) => {\n  if (template != null && typeof template === 'object') {\n    if (Array.isArray(template)) {\n      template.forEach(v => replaceText(text, v));\n      return;\n    }\n    if (typeof template.insert === 'string') {\n      template.insert = text[template.insert] ?? template.insert;\n    }\n    Object.values(template).forEach(v => replaceText(text, v));\n    return;\n  }\n};\n\nfunction seededRNG(seed: string) {\n  const a = 1664525;\n  const c = 1013904223;\n  const m = 2 ** 32;\n  const seededNumber = stringToNumber(seed);\n  return ((a * seededNumber + c) % m) / m;\n\n  function stringToNumber(str: string) {\n    let res = 0;\n    for (let i = 0; i < str.length; i++) {\n      const character = str.charCodeAt(i);\n      res += character;\n    }\n    return res;\n  }\n}\n\nconst getImageUrlByKeyword =\n  (keyword: string) =>\n  async (w: number, h: number): Promise<string> => {\n    const photos = await AIProvider.photoEngine?.searchImages({\n      query: keyword,\n      width: w,\n      height: h,\n    });\n\n    if (photos == null || photos.length === 0) {\n      return ''; // fixme: give a default image\n    }\n\n    // use a stable random seed\n    const rng = seededRNG(`${w}.${h}.${keyword}`);\n    return photos[Math.floor(rng * photos.length)];\n  };\n\nconst getImages = async (\n  images: Record<string, (w: number, h: number) => Promise<string> | string>,\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  template: any\n): Promise<TemplateImage[]> => {\n  const imgs: Record<\n    string,\n    {\n      id: string;\n      width: number;\n      height: number;\n    }\n  > = {};\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const run = (data: any) => {\n    if (data != null && typeof data === 'object') {\n      if (Array.isArray(data)) {\n        data.forEach(v => run(v));\n        return;\n      }\n      if (typeof data.caption === 'string') {\n        const bound = Bound.deserialize(data.xywh);\n        const id = nanoid();\n        data.sourceId = id;\n        imgs[data.caption] = {\n          id: id,\n          width: bound.w,\n          height: bound.h,\n        };\n        delete data.caption;\n      }\n      Object.values(data).forEach(v => run(v));\n      return;\n    }\n  };\n  run(template);\n  const list = await Promise.all(\n    Object.entries(imgs).map(async ([name, data]) => {\n      const getImage = images[name];\n      if (!getImage) {\n        return;\n      }\n      const url = await getImage(data.width, data.height);\n      return {\n        id: data.id,\n        url,\n      } satisfies TemplateImage;\n    })\n  );\n  const notNull = (v?: TemplateImage): v is TemplateImage => {\n    return v != null;\n  };\n  return list.filter(notNull);\n};\n\nexport type PPTSection = {\n  title: string;\n  content: string;\n  keywords: string;\n};\n\nexport type TemplateImage = {\n  id: string;\n  url: string;\n};\n\ntype DocTemplate = {\n  images: TemplateImage[];\n  content: unknown;\n};\n\nconst createBasicCover = async (\n  title: string,\n  section1: PPTSection\n): Promise<DocTemplate> => {\n  const templates = (await import('./templates/cover.json')).default;\n  const template = getRandomElement(templates);\n  replaceText(\n    {\n      title: title,\n      'section1.title': section1.title,\n      'section1.content': section1.content,\n    },\n    template\n  );\n  return {\n    images: await getImages(\n      {\n        'section1.image': getImageUrlByKeyword(section1.keywords),\n      },\n      template\n    ),\n    content: template,\n  };\n};\n\nfunction getRandomElement<T>(arr: T[]): T {\n  return arr[Math.floor(Math.random() * arr.length)];\n}\n\nconst basic1section = async (\n  title: string,\n  section1: PPTSection\n): Promise<DocTemplate> => {\n  const templates = (await import('./templates/one.json')).default;\n  const template = getRandomElement(templates);\n  replaceText(\n    {\n      title: title,\n      'section1.title': section1.title,\n      'section1.content': section1.content,\n    },\n    template\n  );\n  const images = await getImages(\n    {\n      'section1.image': getImageUrlByKeyword(section1.keywords),\n      'section1.image2': getImageUrlByKeyword(section1.keywords),\n      'section1.image3': getImageUrlByKeyword(section1.keywords),\n    },\n    template\n  );\n\n  return {\n    images: images,\n    content: template,\n  };\n};\n\nconst basic2section = async (\n  title: string,\n  section1: PPTSection,\n  section2: PPTSection\n): Promise<DocTemplate> => {\n  const templates = (await import('./templates/two.json')).default;\n  const template = getRandomElement(templates);\n  replaceText(\n    {\n      title: title,\n      'section1.title': section1.title,\n      'section1.content': section1.content,\n      'section2.title': section2.title,\n      'section2.content': section2.content,\n    },\n    template\n  );\n  return {\n    images: await getImages(\n      {\n        'section1.image': getImageUrlByKeyword(section1.keywords),\n        'section2.image': getImageUrlByKeyword(section2.keywords),\n        background: () =>\n          'https://cdn.affine.pro/ppt-images/background/basic_2_selection_background.png',\n      },\n      template\n    ),\n    content: template,\n  };\n};\n\nconst basic3section = async (\n  title: string,\n  section1: PPTSection,\n  section2: PPTSection,\n  section3: PPTSection\n): Promise<DocTemplate> => {\n  const templates = (await import('./templates/three.json')).default;\n  const template = getRandomElement(templates);\n  replaceText(\n    {\n      title: title,\n      'section1.title': section1.title,\n      'section1.content': section1.content,\n      'section2.title': section2.title,\n      'section2.content': section2.content,\n      'section3.title': section3.title,\n      'section3.content': section3.content,\n    },\n    template\n  );\n  return {\n    images: await getImages(\n      {\n        'section1.image': getImageUrlByKeyword(section1.keywords),\n        'section2.image': getImageUrlByKeyword(section2.keywords),\n        'section3.image': getImageUrlByKeyword(section3.keywords),\n        background: () =>\n          'https://cdn.affine.pro/ppt-images/background/basic_3_selection_background.png',\n      },\n      template\n    ),\n    content: template,\n  };\n};\n\nconst basic4section = async (\n  title: string,\n  section1: PPTSection,\n  section2: PPTSection,\n  section3: PPTSection,\n  section4: PPTSection\n): Promise<DocTemplate> => {\n  const templates = (await import('./templates/four.json')).default;\n  const template = getRandomElement(templates);\n  replaceText(\n    {\n      title: title,\n      'section1.title': section1.title,\n      'section1.content': section1.content,\n      'section2.title': section2.title,\n      'section2.content': section2.content,\n      'section3.title': section3.title,\n      'section3.content': section3.content,\n      'section4.title': section4.title,\n      'section4.content': section4.content,\n    },\n    template\n  );\n  return {\n    images: await getImages(\n      {\n        'section1.image': getImageUrlByKeyword(section1.keywords),\n        'section2.image': getImageUrlByKeyword(section2.keywords),\n        'section3.image': getImageUrlByKeyword(section3.keywords),\n        'section4.image': getImageUrlByKeyword(section4.keywords),\n        background: () =>\n          'https://cdn.affine.pro/ppt-images/background/basic_4_selection_background.png',\n      },\n      template\n    ),\n    content: template,\n  };\n};\n\nexport type PPTDoc = {\n  isCover: boolean;\n  title: string;\n  sections: PPTSection[];\n};\n\nexport const basicTheme = (doc: PPTDoc) => {\n  if (doc.isCover) {\n    return createBasicCover(doc.title, doc.sections[0]);\n  }\n  if (doc.sections.length === 1) {\n    return basic1section(doc.title, doc.sections[0]);\n  }\n  if (doc.sections.length === 2) {\n    return basic2section(doc.title, doc.sections[0], doc.sections[1]);\n  }\n  if (doc.sections.length === 3) {\n    return basic3section(\n      doc.title,\n      doc.sections[0],\n      doc.sections[1],\n      doc.sections[2]\n    );\n  }\n  return basic4section(\n    doc.title,\n    doc.sections[0],\n    doc.sections[1],\n    doc.sections[2],\n    doc.sections[3]\n  );\n};\n"]}