{"version":3,"file":"edgeless-editor.js","sourceRoot":"","sources":["../../src/editors/edgeless-editor.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,OAAO,EACL,UAAU,EACV,iBAAiB,EACjB,cAAc,GACf,MAAM,uBAAuB,CAAC;AAC/B,OAAO,EAAE,wBAAwB,EAAE,MAAM,oBAAoB,CAAC;AAC9D,OAAO,EAAE,IAAI,EAAE,MAAM,0BAA0B,CAAC;AAEhD,OAAO,EAAE,GAAG,EAAE,IAAI,EAAE,OAAO,EAAE,MAAM,KAAK,CAAC;AACzC,OAAO,EAAE,aAAa,EAAE,QAAQ,EAAE,MAAM,mBAAmB,CAAC;AAC5D,OAAO,EAAE,SAAS,EAAY,GAAG,EAAE,MAAM,uBAAuB,CAAC;AAEjE,IAAI,CAAC,UAAU,CAAC,CAAC;IAGJ,cAAc;4BAD1B,aAAa,CAAC,iBAAiB,CAAC;;;;sBACG,cAAc,CAAC,iBAAiB,CAAC;;;;;;;8BAAzC,SAAQ,WAAiC;;;;+BAiClE,QAAQ,CAAC,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC;iCAG9B,QAAQ,CAAC,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC;YAF/B,8JAAS,GAAG,6BAAH,GAAG,iFAAO;YAGnB,oKAAS,KAAK,6BAAL,KAAK,qFAA4B;YArC5C,6KAiEC;;;;QAhEC,IAAI,IAAI;YACN,OAAO,IAAI,CAAC,KAAK,CAAC,KAAmB,CAAC;QACxC,CAAC;iBAEe,WAAM,GAAG,GAAG,CAAA;;;;;;;;;;;;;;;;;;;;;;;;GAwB3B,AAxBqB,CAwBpB;QAKF,sBAAmB;QAAnB,IAAS,GAAG,yCAAO;QAAnB,IAAS,GAAG,+CAAO;QAGnB,wBAA0C;QAA1C,IAAS,KAAK,2CAA4B;QAA1C,IAAS,KAAK,iDAA4B;QAEjC,iBAAiB;YACxB,KAAK,CAAC,iBAAiB,EAAE,CAAC;YAC1B,IAAI,CAAC,YAAY,CAAC,GAAG,CACnB,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,SAAS,CAAC,EAAE,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,aAAa,EAAE,CAAC,CACxD,CAAC;QACJ,CAAC;QAEQ,KAAK,CAAC,iBAAiB;YAC9B,MAAM,MAAM,GAAG,MAAM,KAAK,CAAC,iBAAiB,EAAE,CAAC;YAC/C,MAAM,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC;YAC/B,OAAO,MAAM,CAAC;QAChB,CAAC;QAEQ,MAAM;YACb,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,IAAI;gBAAE,OAAO,OAAO,CAAC;YAEnC,OAAO,IAAI,CAAA;;;YAGH,GAAG,CAAC,IAAI,CAAC,KAAK,CAAC;iBACV,IAAI,CAAC,GAAG;mBACN,IAAI,CAAC,KAAK;;;KAGxB,CAAC;QACJ,CAAC;;;YAjCO,UAAK,GAAoB,SAAS,EAAc,CAAC;YAGhD,gFAAU;YAGV,8HAAQ,wBAAwB,GAAC;;;;YArC/B,uDAAc;;;;;SAAd,cAAc","sourcesContent":["import {\n  EditorHost,\n  ShadowlessElement,\n  WithDisposable,\n} from '@blocksuite/block-std';\nimport { EdgelessEditorBlockSpecs } from '@blocksuite/blocks';\nimport { noop } from '@blocksuite/global/utils';\nimport type { Doc } from '@blocksuite/store';\nimport { css, html, nothing } from 'lit';\nimport { customElement, property } from 'lit/decorators.js';\nimport { createRef, type Ref, ref } from 'lit/directives/ref.js';\n\nnoop(EditorHost);\n\n@customElement('edgeless-editor')\nexport class EdgelessEditor extends WithDisposable(ShadowlessElement) {\n  get host() {\n    return this._host.value as EditorHost;\n  }\n\n  static override styles = css`\n    edgeless-editor {\n      font-family: var(--affine-font-family);\n      background: var(--affine-background-primary-color);\n    }\n\n    edgeless-editor * {\n      box-sizing: border-box;\n    }\n\n    @media print {\n      edgeless-editor {\n        height: auto;\n      }\n    }\n\n    .affine-edgeless-viewport {\n      display: block;\n      height: 100%;\n      position: relative;\n      overflow: clip;\n      container-name: viewport;\n      container-type: inline-size;\n    }\n  `;\n\n  private _host: Ref<EditorHost> = createRef<EditorHost>();\n\n  @property({ attribute: false })\n  accessor doc!: Doc;\n\n  @property({ attribute: false })\n  accessor specs = EdgelessEditorBlockSpecs;\n\n  override connectedCallback() {\n    super.connectedCallback();\n    this._disposables.add(\n      this.doc.slots.rootAdded.on(() => this.requestUpdate())\n    );\n  }\n\n  override async getUpdateComplete(): Promise<boolean> {\n    const result = await super.getUpdateComplete();\n    await this.host.updateComplete;\n    return result;\n  }\n\n  override render() {\n    if (!this.doc.root) return nothing;\n\n    return html`\n      <div class=\"affine-edgeless-viewport\">\n        <editor-host\n          ${ref(this._host)}\n          .doc=${this.doc}\n          .specs=${this.specs}\n        ></editor-host>\n      </div>\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'edgeless-editor': EdgelessEditor;\n  }\n}\n"]}