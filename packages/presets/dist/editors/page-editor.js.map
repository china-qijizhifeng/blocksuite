{"version":3,"file":"page-editor.js","sourceRoot":"","sources":["../../src/editors/page-editor.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,OAAO,EACL,UAAU,EACV,iBAAiB,EACjB,cAAc,GACf,MAAM,uBAAuB,CAAC;AAC/B,OAAO,EAAE,oBAAoB,EAAE,MAAM,oBAAoB,CAAC;AAC1D,OAAO,EAAE,IAAI,EAAE,MAAM,0BAA0B,CAAC;AAEhD,OAAO,EAAE,GAAG,EAAE,IAAI,EAAE,OAAO,EAAE,MAAM,KAAK,CAAC;AACzC,OAAO,EAAE,aAAa,EAAE,QAAQ,EAAE,MAAM,mBAAmB,CAAC;AAC5D,OAAO,EAAE,SAAS,EAAY,GAAG,EAAE,MAAM,uBAAuB,CAAC;AAEjE,IAAI,CAAC,UAAU,CAAC,CAAC;IAGJ,UAAU;4BADtB,aAAa,CAAC,aAAa,CAAC;;;;sBACG,cAAc,CAAC,iBAAiB,CAAC;;;;;;;;;;0BAAzC,SAAQ,WAAiC;;;;+BAsC9D,QAAQ,CAAC,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC;iCAG9B,QAAQ,CAAC,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC;uCAG9B,QAAQ,CAAC,EAAE,IAAI,EAAE,OAAO,EAAE,CAAC;YAL5B,8JAAS,GAAG,6BAAH,GAAG,iFAAO;YAGnB,oKAAS,KAAK,6BAAL,KAAK,qFAAwB;YAGtC,sLAAS,WAAW,6BAAX,WAAW,iGAAQ;YA7C9B,6KA6EC;;;;QA5EC,IAAI,IAAI;YACN,OAAO,IAAI,CAAC,KAAK,CAAC,KAAmB,CAAC;QACxC,CAAC;iBAEe,WAAM,GAAG,GAAG,CAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;GA6B3B,AA7BqB,CA6BpB;QAKF,sBAAmB;QAAnB,IAAS,GAAG,yCAAO;QAAnB,IAAS,GAAG,+CAAO;QAGnB,wBAAsC;QAAtC,IAAS,KAAK,2CAAwB;QAAtC,IAAS,KAAK,iDAAwB;QAGtC,8BAA4B;QAA5B,IAAS,WAAW,iDAAQ;QAA5B,IAAS,WAAW,uDAAQ;QAEnB,iBAAiB;YACxB,KAAK,CAAC,iBAAiB,EAAE,CAAC;YAC1B,IAAI,CAAC,YAAY,CAAC,GAAG,CACnB,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,SAAS,CAAC,EAAE,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,aAAa,EAAE,CAAC,CACxD,CAAC;QACJ,CAAC;QAEQ,KAAK,CAAC,iBAAiB;YAC9B,MAAM,MAAM,GAAG,MAAM,KAAK,CAAC,iBAAiB,EAAE,CAAC;YAC/C,MAAM,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC;YAC/B,OAAO,MAAM,CAAC;QAChB,CAAC;QAEQ,MAAM;YACb,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,IAAI;gBAAE,OAAO,OAAO,CAAC;YAEnC,OAAO,IAAI,CAAA;;gBAEC,IAAI,CAAC,WAAW;gBACtB,CAAC,CAAC,sBAAsB;gBACxB,CAAC,CAAC,uBAAuB;;;YAGvB,GAAG,CAAC,IAAI,CAAC,KAAK,CAAC;iBACV,IAAI,CAAC,GAAG;mBACN,IAAI,CAAC,KAAK;;;KAGxB,CAAC;QACJ,CAAC;;;YAxCO,UAAK,GAAoB,SAAS,EAAc,CAAC;YAGhD,gFAAU;YAGV,8HAAQ,oBAAoB,GAAC;YAG7B,4IAAc,IAAI,GAAC;;;;YA7CjB,uDAAU;;;;;SAAV,UAAU","sourcesContent":["import {\n  EditorHost,\n  ShadowlessElement,\n  WithDisposable,\n} from '@blocksuite/block-std';\nimport { PageEditorBlockSpecs } from '@blocksuite/blocks';\nimport { noop } from '@blocksuite/global/utils';\nimport type { Doc } from '@blocksuite/store';\nimport { css, html, nothing } from 'lit';\nimport { customElement, property } from 'lit/decorators.js';\nimport { createRef, type Ref, ref } from 'lit/directives/ref.js';\n\nnoop(EditorHost);\n\n@customElement('page-editor')\nexport class PageEditor extends WithDisposable(ShadowlessElement) {\n  get host() {\n    return this._host.value as EditorHost;\n  }\n\n  static override styles = css`\n    page-editor {\n      font-family: var(--affine-font-family);\n      background: var(--affine-background-primary-color);\n    }\n\n    page-editor * {\n      box-sizing: border-box;\n    }\n\n    @media print {\n      page-editor {\n        height: auto;\n      }\n    }\n\n    .affine-page-viewport {\n      position: relative;\n      height: 100%;\n      overflow-x: hidden;\n      overflow-y: auto;\n      container-name: viewport;\n      container-type: inline-size;\n    }\n\n    .page-editor-container {\n      display: block;\n      height: 100%;\n    }\n  `;\n\n  private _host: Ref<EditorHost> = createRef<EditorHost>();\n\n  @property({ attribute: false })\n  accessor doc!: Doc;\n\n  @property({ attribute: false })\n  accessor specs = PageEditorBlockSpecs;\n\n  @property({ type: Boolean })\n  accessor hasViewport = true;\n\n  override connectedCallback() {\n    super.connectedCallback();\n    this._disposables.add(\n      this.doc.slots.rootAdded.on(() => this.requestUpdate())\n    );\n  }\n\n  override async getUpdateComplete(): Promise<boolean> {\n    const result = await super.getUpdateComplete();\n    await this.host.updateComplete;\n    return result;\n  }\n\n  override render() {\n    if (!this.doc.root) return nothing;\n\n    return html`\n      <div\n        class=${this.hasViewport\n          ? 'affine-page-viewport'\n          : 'page-editor-container'}\n      >\n        <editor-host\n          ${ref(this._host)}\n          .doc=${this.doc}\n          .specs=${this.specs}\n        ></editor-host>\n      </div>\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'page-editor': PageEditor;\n  }\n}\n"]}